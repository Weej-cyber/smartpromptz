<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThinkPrompt - Professional Prompt Builder</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      color: #1e293b;
      line-height: 1.6;
      font-size: 16px;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    /* NEW: Wrapper for centered content */
    .page-wrapper {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px;
    }
    
    /* HEADER */
    .brand-header {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 36px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      color: white;
    }

    /* Using flexbox like existing components */
    .brand-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    
    /* Logo: 10% smaller (126px) */
    .brand-logo .weej-logo {
      width: 126px;
      height: auto;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }
    
    /* Title with flex-grow for responsive centering */
    .app-title {
      font-family: -apple-system,BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 48px; 
      font-weight: 900; 
      background:linear-gradient(180deg, #ffffff 0%, #e2e8f0 100%);
      -webkit-background-clip: text; 
      -webkit-text-fill-color: transparent; 
      background-clip: text; 
      margin: 0;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7); 
      letter-spacing: -0.8px; 
      flex-grow: 1; 
      text-align: center;
    }
    
    /* THINK section - following app's panel patterns */
    .think-section {
      background: #374151;
      border: 1px solid #4b5563;
      border-radius: 8px;
      padding: 16px 24px;
      margin: 0 auto;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    
    /* Bold white text with outline - like you requested */
    .think-title {
      font-family: Impact, Arial Black, sans-serif;
      font-size: 24px;
      font-weight: 900;
      color: white;
      -webkit-text-stroke: 2px #000;
      margin-bottom: 8px;
      letter-spacing: 1px;
    }
    
    /* Following existing button group patterns */
    .think-methodology {
      display: flex;
      justify-content: center;
      gap: 16px;
      font-size: 12px;
      flex-wrap: wrap;
    }
    
    .think-step {
      font-weight: 600;
      color: white;
    }

    .quality-panel {
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      border: 2px solid #22c55e;
      border-radius: 12px;
      padding: 16px 20px;
      margin: 0 0 24px 0;
      box-shadow: 0 4px 16px rgba(34, 197, 94, 0.2), 0 2px 8px rgba(0, 0, 0, 0.3);
      position: relative;
    }
    
    .quality-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
      border-radius: 12px 12px 0 0;
    }
    
    .quality-title {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 10px;
      font-size: 16px;
      font-weight: 700;
      color: #ffffff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }
    
    .quality-icon {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    /* HONEST COMPLETION SYSTEM STYLES */
    .completion-status-panel {
      background: linear-gradient(135deg, #1e293b, #374151);
      border: 3px solid #3b82f6;
      border-radius: 16px;
      padding: 24px;
      margin: 16px 0;
      text-align: center;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    }

    .status-display {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
    }

    .status-icon {
      font-size: 32px;
      line-height: 1;
    }

    .status-content {
      text-align: left;
    }

    .status-level {
      font-size: 24px;
      font-weight: 900;
      font-family: 'Impact', 'Arial Black', sans-serif;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .status-level.status-none { color: #6b7280; }
    .status-level.status-incomplete { color: #ef4444; }
    .status-level.status-ready { color: #eab308; }
    .status-level.status-optimized { color: #10b981; }

    .status-message {
      font-size: 14px;
      font-weight: 600;
      color: #e5e7eb;
      margin-top: 4px;
      line-height: 1.3;
    }

    @media (max-width: 640px) {
      .status-display { flex-direction: column; gap: 12px; }
      .status-content { text-align: center; }
      .status-level { font-size: 20px; }
      .status-message { font-size: 13px; }
    }

    /* UNIFIED CONTAINER */
    .container {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 0;
      border: 1px solid rgba(255, 255, 255, 0.2);
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      border-left: none;
      border-right: none;
    }

    .card:first-child {
      border-radius: 16px 16px 0 0;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .card:last-child {
      border-radius: 0 0 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .card:only-child {
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    /* CATEGORY TABS */
    .categories-section {
      padding: 0;
    }
    
    .categories-title-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 28px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid #374151;
    }
    
    .categories-title-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .categories-title {
      color: #ffffff;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }
    
    .category-tabs-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 24px;
      border-top: 1px solid #374151;
      border-bottom: 1px solid #374151;
      position: relative;
    }
    
    .category-tabs-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .category-tabs-container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .category-tabs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .category-tab {
      padding: 16px 20px;
      border: 2px solid #374151;
      border-radius: 12px;
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      color: #22c55e;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-height: 56px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .category-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(34, 197, 94, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }
    
    .category-tab:hover::before {
      transform: translateX(100%);
    }
    
    .category-tab:hover {
      border-color: #22c55e;
      color: #ffffff;
      background: linear-gradient(135deg, #2d2d2d, #404040);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(34, 197, 94, 0.2);
    }
    
    .category-tab.active {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #000000;
      border-color: #22c55e;
      box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
      transform: translateY(-2px);
    }
    
    .category-tab.active::before {
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }
    
    /* TEMPLATES SECTION */
    .templates-section {
      padding: 0;
      display: none;
    }
    
    .templates-section.show {
      display: block;
    }
    
    .templates-section .templates-header {
      background: linear-gradient(135deg, #000000, #1a1a1a) !important;
      padding: 20px 28px;
      border-top: 1px solid #374151;
      text-align: center;
      position: relative;
    }
    
    .templates-section .templates-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .templates-section .templates-title {
      color: #ffffff !important;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }
    
    .templates-content {
      padding: 20px;
      background: rgba(255, 255, 255, 0.95);
    }
    
    .templates-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
    }
    
    .template-card {
      padding: 16px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      background: white;
      position: relative;
    }
    
    .template-card:hover {
      border-color: #dc2626;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.1);
    }
    
    .template-card.selected {
      border-color: #dc2626;
      background: #fef2f2;
    }
    
    .template-name {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 4px;
    }
    
    .template-desc {
      font-size: 13px;
      color: #64748b;
    }
    
    /* FORM SECTION */
    .form-section {
      padding: 32px;
      display: none;
    }
    
    .form-section.show {
      display: block;
    }
    
    .form-group {
      margin-bottom: 28px;
    }
    
    .form-label {
      display: block;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .form-textarea {
      width: 100%;
      padding: 18px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 16px;
      resize: vertical;
      min-height: 110px;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
    }

    .form-textarea.form-select {
      min-height: auto;
      height: 56px;
      resize: none;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 20px center;
      background-repeat: no-repeat;
      background-size: 22px;
      padding-right: 60px;
    }
    
    .form-textarea:focus {
      outline: none;
      border-color: #dc2626;
      box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.1);
      background: rgba(255, 255, 255, 0.95);
    }

    /* Short fields - single line inputs */ 
    #role, #tone {
      min-height: 50px; 
    } 

    /* Medium fields - 2-3 line inputs */ 
    #goal, #constraints { 
      min-height: 70px; 
    } 

    /* Long fields - multi-paragraph content */ 
    #context, #examples { 
      min-height: 90px; 
    } 

    /* Format dropdown - no height change needed */ 
    #format { 
      min-height: 56px; /* Keep existing dropdown height */ 
    }
    
    .form-hint {
      font-size: 14px;
      color: #6b7280;
      margin-top: 6px;
      line-height: 1.4;
    }
    
    /* WORKBENCH STYLES */
    :root {
      --workbench-color: #3b82f6;
      --workbench-active-bg: #3b82f6;
      --workbench-active-text: white;
      --workbench-hover-bg: #2563eb;
    }

    .workbench-title-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 28px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid #374151;
    }
    
    .workbench-title-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--workbench-color), transparent);
    }
    
    .workbench-title {
      color: #ffffff;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }

    .workbench-description {
      color: #94a3b8;
      font-size: 14px;
      font-weight: 500;
      margin-top: 8px;
      opacity: 0.9;
    }
    
    .workbench-tabs-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 24px;
      border-top: 1px solid #374151;
      border-bottom: 1px solid #374151;
      position: relative;
    }
    
    .workbench-tabs-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--workbench-color), transparent);
    }
    
    .workbench-tabs-container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--workbench-color), transparent);
    }
    
    .workbench-tabs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .workbench-tab {
      padding: 16px 20px;
      border: 2px solid #374151;
      border-radius: 12px;
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      color: var(--workbench-color);
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-height: 56px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .workbench-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(59, 130, 246, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }
    
    .workbench-tab:hover::before {
      transform: translateX(100%);
    }
    
    .workbench-tab:hover {
      border-color: var(--workbench-color);
      color: #ffffff;
      background: linear-gradient(135deg, #2d2d2d, #404040);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
    }
    
    .workbench-tab.active {
      background: linear-gradient(135deg, var(--workbench-color), var(--workbench-hover-bg));
      color: var(--workbench-active-text);
      border-color: var(--workbench-color);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
      transform: translateY(-2px);
    }
    
    .workbench-tab.active::before {
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }

    .workbench-content {
      padding: 20px;
      background: rgba(255, 255, 255, 0.95);
    }

    .starter-prompt-item {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.2s ease;
    }

    .starter-prompt-item:hover {
      border-color: var(--workbench-color);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
    }

    .prompt-item-title {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 8px;
    }

    .prompt-rating {
      color: #fbbf24;
      font-size: 14px;
      font-weight: 600;
    }

    .prompt-item-preview {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      padding: 12px;
      font-size: 13px;
      color: #64748b;
      line-height: 1.4;
      margin: 12px 0;
      max-height: 80px;
      overflow: hidden;
      position: relative;
    }

    .prompt-item-preview::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 20px;
      background: linear-gradient(transparent, #f8fafc);
    }

    .prompt-item-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .add-prompt-form {
      background: linear-gradient(135deg, #1f2937, #374151);
      border: 2px solid #4b5563;
      border-radius: 15px;
      padding: 25px;
      max-width: 600px;
      margin: 0 auto;
      color: white;
    }

    .add-prompt-form .form-group {
      margin-bottom: 20px;
    }

    .add-prompt-form .form-group label {
      display: block;
      color: var(--workbench-color);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .add-prompt-form .form-group input,
    .add-prompt-form .form-group textarea,
    .add-prompt-form .form-group select {
      width: 100%;
      padding: 12px;
      background: #0f172a;
      border: 2px solid #374151;
      border-radius: 8px;
      color: #ffffff;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .add-prompt-form .form-group input:focus,
    .add-prompt-form .form-group textarea:focus,
    .add-prompt-form .form-group select:focus {
      outline: none;
      border-color: var(--workbench-color);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .add-prompt-form .form-group textarea {
      height: 120px;
      resize: vertical;
      font-family: 'Monaco', 'Menlo', monospace;
    }

/* OUTPUT ACTION TABS - Yellow Theme */
.output-actions-container {
  background: linear-gradient(135deg, #000000, #1a1a1a);
  padding: 24px;
  border-top: 1px solid #374151;
  border-bottom: 1px solid #374151;
  position: relative;
}

.output-actions-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, #eab308, transparent);
}

.output-actions-container::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, #eab308, transparent);
}

.output-actions {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  flex-wrap: wrap;
  max-width: 800px;
  margin: 0 auto;
}

.output-nav-button {
  padding: 12px 20px;
  background: linear-gradient(135deg, #ffffff, #f8fafc);
  color: #374151;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.output-nav-button:hover {
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  border-color: #9ca3af;
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.output-action-tab {
  padding: 12px 20px;
  border: 2px solid #374151;
  border-radius: 12px;
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  color: #eab308;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  min-height: 48px;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.output-action-tab::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent, rgba(234, 179, 8, 0.1), transparent);
  transform: translateX(-100%);
  transition: transform 0.6s;
}

.output-action-tab:hover::before {
  transform: translateX(100%);
}

.output-action-tab:hover {
  border-color: #eab308;
  color: #ffffff;
  background: linear-gradient(135deg, #2d2d2d, #404040);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(234, 179, 8, 0.2);
}

@media (max-width: 768px) {
  .output-actions {
    flex-direction: column;
    gap: 12px;
  }
  
  .output-action-tab, .output-nav-button {
    width: 100%;
    justify-content: center;
  }
}
    
    /* BUTTONS */
    .action-buttons {
      display: flex;
      gap: 16px;
      margin-top: 32px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 16px 32px;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
      min-height: 72px;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }
    
    .btn:hover::before {
      transform: translateX(100%);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #16a34a, #15803d);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, #ffffff, #f8fafc);
      color: #374151;
      border: 1px solid #d1d5db;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .btn-secondary:hover {
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      border-color: #9ca3af;
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .btn-blue {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
    }
    
    .btn-blue:hover {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
    }
    
    .btn-purple {
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      color: white;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
    }
    
    .btn-purple:hover {
      background: linear-gradient(135deg, #7c3aed, #6d28d9);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
    }
    
    .btn-small {
      padding: 8px 16px;
      font-size: 13px;
      min-height: auto;
      font-weight: 600;
    }
    
    /* OUTPUT SECTION - NEW HEADER STYLES */
    .output-section {
      background: white;
      border-radius: 16px;
      margin-top: 16px;
      min-height: 240px;
      box-shadow: 0 16px 50px rgba(0,0,0,0.12);
      overflow: hidden;
      border: 1px solid #e5e7eb;
      display: none;
    }
    
    .output-section.show {
      display: block;
    }
    
    /* NEW: Output section header following the same pattern as other sections */
    .output-title-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 28px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid #374151;
    }
    
    .output-title-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #dc2626, transparent);
    }
    
    .output-title {
      color: #ffffff;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }

    .output-description {
      color: #94a3b8;
      font-size: 14px;
      font-weight: 500;
      margin-top: 8px;
      opacity: 0.9;
    }
    
    .output-content {
      padding: 32px 28px;
      min-height: 140px;
    }
    
    .output-textarea {
      width: 100%;
      min-height: 300px;
      padding: 20px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      color: #1e293b;
      resize: vertical;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    
    .output-textarea:focus {
      outline: none;
      border-color: #dc2626;
      box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.1);
      background: rgba(255, 255, 255, 0.95);
    }
    
    .welcome-state {
      padding: 60px 24px;
      text-align: center;
      color: #64748b;
      background: rgba(255, 255, 255, 0.95);
    }
    
    .welcome-icon {
      font-size: 48px;
      margin-bottom: 20px;
      opacity: 0.6;
    }
    
    .welcome-icon svg {
      width: 48px;
      height: 48px;
    }
    
    .welcome-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      color: #374151;
    }
    
    .welcome-text {
      font-size: 14px;
      line-height: 1.5;
    }
    
    .empty-workbench {
      text-align: center;
      padding: 40px 20px;
      color: #9ca3af;
    }

    .empty-workbench-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    
    /* COPY SUCCESS MESSAGE */
    .copy-success {
      position: fixed;
      top: 100px;
      right: 20px;
      background: #10b981;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      z-index: 2000;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .copy-success.show {
      transform: translateX(0);
    }
    
    .copy-success svg {
      width: 16px;
      height: 16px;
    }
    
    /* SVG Icon Styles */
    .icon {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    /* LOADING ANIMATION */
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .animate-spin {
      animation: spin 1s linear infinite;
    }
    
    /* RESPONSIVE */
    @media (max-width: 768px) {
      .page-wrapper {
        padding: 24px;
      }
      
      .brand-header {
        padding: 28px 24px;
      }
      
      /* Stack logo and title on mobile like other components */
      .brand-row {
        flex-direction: column;
        align-items: center;
        gap: 16px;
        text-align: center;
      }
      
      .brand-logo .weej-logo {
        width: 100px;
      }
      
      .app-title {
        font-size: 32px;
      }
      
      .think-methodology {
        gap: 10px;
      }
      
      .category-tabs, .workbench-tabs {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 12px;
      }
      
      .category-tab, .workbench-tab {
        padding: 18px 20px;
        font-size: 15px;
        min-height: 60px;
      }
      
      .templates-grid {
        grid-template-columns: 1fr;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .output-actions {
        flex-direction: column;
        gap: 12px;
      }
    }
    
    @media (max-width: 480px) {
      .category-tabs, .workbench-tabs {
        grid-template-columns: 1fr 1fr;
        gap: 8px;
      }
      
      .category-tab, .workbench-tab {
        padding: 16px 18px;
        font-size: 14px;
        min-height: 56px;
      }
    }
  </style>
</head>
<body>
<div class="page-wrapper">
  <!-- COPY SUCCESS MESSAGE -->
  <div class="copy-success" id="copySuccess">
    <svg class="icon" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"></polyline></svg>
    Copied to clipboard!
  </div>

  <!-- HEADER -->
  <header class="brand-header">
    <div class="brand-row">
      <div class="brand-logo">
        <svg class="weej-logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="shieldGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#1e40af;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#3b82f6;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="wifiGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#0ea5e9;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#0284c7;stop-opacity:1" />
            </linearGradient>
            <filter id="innerShadow">
              <feDropShadow dx="2" dy="3" stdDeviation="3" flood-color="rgba(0,0,0,0.3)"/>
            </filter>
          </defs>
          <path d="M52 62 Q72 122 102 142 Q132 122 152 62 Q102 42 52 62 Z" fill="rgba(0,0,0,0.2)" stroke="none"/>
          <path d="M50 60 Q70 120 100 140 Q130 120 150 60 Q100 40 50 60 Z" fill="url(#shieldGrad)" stroke="#1e40af" stroke-width="2" filter="url(#innerShadow)"/>
          <path d="M55 62 Q72 115 100 132 Q128 115 145 62 Q100 45 55 62 Z" fill="rgba(255,255,255,0.9)" stroke="none"/>
          <path d="M68 70 Q100 58 132 70" stroke="url(#wifiGrad)" stroke-width="5" fill="none" stroke-linecap="round"/>
          <path d="M73 78 Q100 68 127 78" stroke="url(#wifiGrad)" stroke-width="5" fill="none" stroke-linecap="round"/>
          <path d="M78 86 Q100 78 122 86" stroke="url(#wifiGrad)" stroke-width="5" fill="none" stroke-linecap="round"/>
          <path d="M83 94 Q100 88 117 94" stroke="url(#wifiGrad)" stroke-width="4" fill="none" stroke-linecap="round"/>
          <path d="M88 102 Q100 98 112 102" stroke="url(#wifiGrad)" stroke-width="4" fill="none" stroke-linecap="round"/>
          <path d="M68 70 Q100 58 132 70" stroke="#06b6d4" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
          <path d="M73 78 Q100 68 127 78" stroke="#06b6d4" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
          <path d="M78 86 Q100 78 122 86" stroke="#06b6d4" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
          <path d="M83 94 Q100 88 117 94" stroke="#06b6d4" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
          <path d="M88 102 Q100 98 112 102" stroke="#06b6d4" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
          <circle cx="100" cy="110" r="5" fill="url(#wifiGrad)" filter="url(#innerShadow)"/>
          <circle cx="100" cy="110" r="3" fill="#06b6d4"/>
        </svg>
      </div>
      
      <h1 class="app-title">ThinkPrompt</h1>
    </div>
    
    <div class="think-section">
      <div class="think-title">THINK</div>
      <div class="think-methodology">
        <span class="think-step">T - Thought</span>
        <span class="think-step">H - How</span>
        <span class="think-step">I - Improve</span>
        <span class="think-step">N - Needs met</span>
        <span class="think-step">K - Keep</span>
      </div>
    </div>
  </header>

  <div class="container">
    
    <!-- 1. BUILD CUSTOM PROMPTS - CATEGORIES -->
    <section class="card">
      <div class="categories-section">
        <div class="categories-title-container">
          <h2 class="categories-title">BUILD CUSTOM PROMPTS WITH TEMPLATES</h2>
        </div>
        <div class="category-tabs-container">
          <div class="category-tabs">
            <button class="category-tab" data-category="email">
              <svg class="icon" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
              Email
            </button>
            <button class="category-tab" data-category="creative">
              <svg class="icon" viewBox="0 0 24 24"><path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="m2 2 7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle></svg>
              Creative
            </button>
            <button class="category-tab" data-category="video">
              <svg class="icon" viewBox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect width="15" height="14" x="1" y="5" rx="2" ry="2"></rect></svg>
              Video
            </button>
            <button class="category-tab" data-category="social">
              <svg class="icon" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
              Social
            </button>
            <button class="category-tab" data-category="career">
              <svg class="icon" viewBox="0 0 24 24"><rect width="20" height="14" x="2" y="7" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
              Career
            </button>
            <button class="category-tab" data-category="business">
              <svg class="icon" viewBox="0 0 24 24"><path d="M2 20h20"></path><path d="M5 20V9l5-5 5 5v11"></path><path d="M9 9v11"></path><path d="M15 9v11"></path></svg>
              Business
            </button>
            <button class="category-tab" data-category="custom">
              <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m15.5-6.5L17 7m-10 5L3.5 8.5m0 7L7 17m10-5l3.5 3.5"></path></svg>
              Custom
            </button>
          </div>
        </div>
      </div>
      
      <!-- TEMPLATES -->
      <div class="templates-section" id="templatesSection">
        <div class="templates-header">
          <h3 class="templates-title">SELECT A CATEGORY ABOVE</h3>
        </div>
        <div class="templates-content">
          <div class="welcome-state">
            <div class="welcome-icon">
              <svg viewBox="0 0 24 24" width="48" height="48" stroke="currentColor" fill="none" stroke-width="2"><line x1="12" x2="12" y1="19" y2="5"></line><polyline points="5,12 12,5 19,12"></polyline></svg>
            </div>
            <h3 class="welcome-title">Choose a Category to Begin</h3>
            <p class="welcome-text">Select from the categories above to view professional templates and get started with your prompt.</p>
          </div>
        </div>
      </div>
    </section>
    
    <!-- 2. FORM -->
    <section class="card">
      <!-- COMPLETION STATUS PANEL TOP -->
      <div class="quality-panel" id="qualityPanel" style="display: none;">
        <div class="quality-title">
          <svg class="quality-icon" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="m9 12 2 2 4-4"></path>
          </svg>
          PROMPT COMPLETION ASSISTANT
        </div>
        <div class="completion-status-panel">
          <div class="status-display">
            <span class="status-icon" id="statusIcon">⚪</span>
            <div class="status-content">
              <div class="status-level" id="statusLevel">WAITING</div>
              <div class="status-message" id="statusMessage">Select template, begin filling out form</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="form-section" id="formSection">
        
        <div class="form-group" id="roleGroup" style="display: none;">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="m22 21-3-3m0 0a2 2 0 0 0-3-3 2 2 0 0 0-3 3c0 1 1 2 2 2s2-1 2-2"></path></svg>
            AI Role
          </label>
          <textarea class="form-textarea" id="role" placeholder="You are a marketing expert, technical writer, creative storyteller..." rows="2"></textarea>
          <div class="form-hint" id="roleHint">Define what type of expert the AI should be</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
            Goal
          </label>
          <textarea class="form-textarea" id="goal" placeholder="What do you want the AI to accomplish?" rows="2"></textarea>
          <div class="form-hint" id="goalHint">Be specific about your desired outcome and success criteria</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>
            Context
          </label>
          <textarea class="form-textarea" id="context" placeholder="Provide background information..." rows="3"></textarea>
          <div class="form-hint" id="contextHint">Provide background: audience, industry, constraints, current situation</div>
        </div>
        
        <div class="form-group" id="formatGroup" style="display: none;">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><rect width="18" height="7" x="3" y="3" rx="1"></rect><rect width="9" height="7" x="3" y="14" rx="1"></rect><rect width="5" height="7" x="16" y="14" rx="1"></rect></svg>
            Output Format
          </label>
          <select class="form-textarea form-select" id="format">
            <option value="">Choose format...</option>
            <option value="paragraph">Paragraph</option>
            <option value="list">List</option>
            <option value="table">Table</option>
            <option value="table">Code block</option>
            <option value="dialogue">Dialogue</option>
            <option value="step-by-step">Step-by-step</option>
          </select>
          <div class="form-hint" id="formatHint">Structure affects readability and usability of the response</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
            Tone/Style
          </label>
          <textarea class="form-textarea" id="tone" placeholder="Professional, casual, witty" rows="1"></textarea>
          <div class="form-hint" id="toneHint">Define voice and personality that matches your audience</div>
        </div>
        
        <div class="form-group" id="constraintsGroup" style="display: none;">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M9 12l2 2 4-4"></path><path d="M21 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M3 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M12 21c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M12 3c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M18.364 18.364c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0-.39 1.024 0 1.414 1.024.39 1.414 0"></path><path d="M6.05 6.05c.39-.39.39-1.024 0-1.414s-1.024-.39-1.414 0-.39 1.024 0 1.414 1.024.39 1.414 0"></path><path d="M18.364 5.636c.39.39 1.024.39 1.414 0s.39-1.024 0-1.414-1.024-.39-1.414 0-.39 1.024 0 1.414"></path><path d="M6.05 17.95c.39.39 1.024.39 1.414 0s.39-1.024 0-1.414-1.024-.39-1.414 0-.39 1.024 0 1.414"></path></svg>
            Constraints
          </label>
          <textarea class="form-textarea" id="constraints" placeholder="e.g., Keep under 100 words, use simple language" rows="2"></textarea>
          <div class="form-hint" id="constraintsHint">Set clear boundaries and requirements</div>
        </div>
        
        <div class="form-group" id="examplesGroup" style="display: none;">
          <label class="form-label">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>
            Examples
          </label>
          <textarea class="form-textarea" id="examples" placeholder="Show sample outputs to guide the AI..." rows="3"></textarea>
          <div class="form-hint" id="examplesHint">Show 2-3 concrete examples of exactly what you want</div>
        </div>
        
        <!-- BOTTOM COMPLETION STATUS PANEL -->
        <div class="quality-panel" id="qualityPanelBottom" style="display: none;">
          <div class="quality-title">
            <svg class="quality-icon" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="m9 12 2 2 4-4"></path>
            </svg>
            PROMPT COMPLETION ASSISTANT
          </div>
          <div class="completion-status-panel">
            <div class="status-display">
              <span class="status-icon" id="statusIconBottom">⚪</span>
              <div class="status-content">
                <div class="status-level" id="statusLevelBottom">WAITING</div>
                <div class="status-message" id="statusMessageBottom">Select template, begin filling out form</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="action-buttons">
          <button class="btn btn-primary" onclick="generatePrompt()">
            <svg class="icon" viewBox="0 0 24 24" width="16" height="16"><polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon></svg>
            Generate Prompt
          </button>
          <button class="btn btn-secondary" onclick="clearForm()">
            <svg class="icon" viewBox="0 0 24 24" width="16" height="16"><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"></path><path d="M21 16h5v5"></path><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M8 8H3V3"></path></svg>
            Clear
          </button>
        </div>
      </div>
    </section>

    <!-- WORKBENCH SECTION -->
    <section class="card">
      <div class="workbench-title-container">
        <h2 class="workbench-title">THINKPROMPT WORKBENCH</h2>
        <p class="workbench-description">Professional prompt collection with 30+ starter prompts and your saved prompts</p>
      </div>
      <div class="workbench-tabs-container">
        <div class="workbench-tabs">
          <button class="workbench-tab active" data-filter="all">All</button>
          <button class="workbench-tab" data-filter="email">Email</button>
          <button class="workbench-tab" data-filter="creative">Creative</button>
          <button class="workbench-tab" data-filter="video">Video</button>
          <button class="workbench-tab" data-filter="social">Social</button>
          <button class="workbench-tab" data-filter="career">Career</button>
          <button class="workbench-tab" data-filter="business">Business</button>
          <button class="workbench-tab" data-filter="my-library">My Library</button>
          <button class="workbench-tab" data-filter="add-new">Add New</button>
        </div>
      </div>
      <div class="workbench-content" id="workbenchContent">
        <!-- Content will be dynamically populated -->
      </div>
    </section>
  </div>

  <!-- OUTPUT SECTION WITH NEW HEADER -->
  <section class="output-section" id="outputSection">
    <!-- NEW: Professional header matching other sections -->
    <div class="output-title-container">
      <h2 class="output-title">REFINE GENERATED PROMPT</h2>
      <p class="output-description">Edit directly below or regenerate with different template</p>
    </div>
    
    <div class="output-actions-container">
      <div class="output-actions">
        <button class="output-nav-button" onclick="tryAnotherTemplate()">
          <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"></path><path d="M21 16h5v5"></path><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M8 8H3V3"></path></svg>
          Try Another Template
        </button>
        
        <button class="output-action-tab" onclick="copyPrompt()">
          <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="m4 16c-1.1 0-2-.9-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>
          Copy Prompt
        </button>
        
        <button class="output-action-tab" onclick="savePrompt()">
          <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17,21 17,13 7,13 7,21"></polyline><polyline points="7,3 7,8 15,8"></polyline></svg>
          Save Prompt
        </button>
        
        <div style="display: flex; gap: 12px;">
          <button class="output-action-tab" onclick="exportCurrentPromptText()">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14,2 14,8 20,8"></polyline></svg>
            Export Text
          </button>
          
          <button class="output-action-tab" onclick="exportCurrentPromptCSV()">
            <svg class="icon" viewBox="0 0 24 24" width="14" height="14"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14,2 14,8 20,8"></polyline></svg>
            Export CSV
          </button>
        </div>
      </div>
    </div>
    
    <div class="output-content" id="outputContent">
      <textarea class="output-textarea" id="outputTextarea" placeholder="Your custom-generated prompt will appear here for editing..."></textarea>
    </div>
    
    <!-- Bottom section removed - functionality moved to tabs above -->
  </section>

  <script>
    // ===== TEMPLATE PERSISTENCE SYSTEM =====
    // Saves form fields for current template so user doesn't lose work
    const TemplatePersistence = {
      STORAGE_KEY: 'thinkprompt_template_data',
      
      getCurrentKey() {
        const category = StateManager.getState().currentCategory;
        const template = StateManager.getState().selectedTemplate;
        
        if (category === 'custom') {
          return 'custom';
        } else if (template && template.name) {
          return `${category}_${template.name}`;
        } else {
          return `${category}_default`;
        }
      },
      
      save() {
        try {
          const key = this.getCurrentKey();
          if (!key) return false;
          
          const formData = FormManager.getFormData();
          const stored = this.getAll();
          stored[key] = {
            ...formData,
            timestamp: new Date().toISOString()
          };
          
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(stored));
          return true;
        } catch (error) {
          console.error('Template save failed:', error);
          return false;
        }
      },
      
      load() {
        try {
          const key = this.getCurrentKey();
          if (!key) return false;
          
          const stored = this.getAll();
          const templateData = stored[key];
          
          if (templateData) {
            Object.keys(templateData).forEach(fieldId => {
              if (fieldId !== 'timestamp') {
                const field = document.getElementById(fieldId);
                if (field && templateData[fieldId]) {
                  field.value = templateData[fieldId];
                }
              }
            });
            
            QualityManager.updateDisplay();
            return true;
          }
          
          return false;
        } catch (error) {
          console.error('Template load failed:', error);
          return false;
        }
      },
      
      clear() {
        try {
          const key = this.getCurrentKey();
          if (!key) return false;
          
          const stored = this.getAll();
          delete stored[key];
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(stored));
          return true;
        } catch (error) {
          console.error('Template clear failed:', error);
          return false;
        }
      },
      
      getAll() {
        try {
          const stored = localStorage.getItem(this.STORAGE_KEY);
          return stored ? JSON.parse(stored) : {};
        } catch (error) {
          console.error('Template getAll failed:', error);
          return {};
        }
      },
      
      cleanup() {
        try {
          const stored = this.getAll();
          const thirtyDaysAgo = new Date();
          thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
          
          let cleaned = 0;
          Object.keys(stored).forEach(key => {
            const data = stored[key];
            if (data.timestamp) {
              const dataDate = new Date(data.timestamp);
              if (dataDate < thirtyDaysAgo) {
                delete stored[key];
                cleaned++;
              }
            }
          });
          
          if (cleaned > 0) {
            localStorage.setItem(this.STORAGE_KEY, JSON.stringify(stored));
          }
          
          return cleaned;
        } catch (error) {
          console.error('Template cleanup failed:', error);
          return 0;
        }
      }
    };

    // ===== SAVED PROMPTS MANAGER =====
    // Handles localStorage persistence for user's saved prompts
    const SavedPromptsManager = {
      STORAGE_KEY: 'thinkprompt_saved_prompts',
      
      getAll() {
        try {
          const stored = localStorage.getItem(this.STORAGE_KEY);
          return stored ? JSON.parse(stored) : [];
        } catch (error) {
          console.error('Error loading saved prompts:', error);
          return [];
        }
      },
      
      save(promptData) {
        try {
          const savedPrompts = this.getAll();
          const newPrompt = {
            id: Date.now(),
            timestamp: new Date().toISOString(),
            ...promptData
          };
          
          savedPrompts.push(newPrompt);
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(savedPrompts));
          return newPrompt;
        } catch (error) {
          console.error('Error saving prompt:', error);
          return null;
        }
      },
      
      delete(promptId) {
        try {
          const savedPrompts = this.getAll();
          const filtered = savedPrompts.filter(p => p.id !== promptId);
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(filtered));
          return true;
        } catch (error) {
          console.error('Error deleting prompt:', error);
          return false;
        }
      },
      
      update(promptId, updates) {
        try {
          const savedPrompts = this.getAll();
          const index = savedPrompts.findIndex(p => p.id === promptId);
          
          if (index !== -1) {
            savedPrompts[index] = { ...savedPrompts[index], ...updates };
            localStorage.setItem(this.STORAGE_KEY, JSON.stringify(savedPrompts));
            return savedPrompts[index];
          }
          
          return null;
        } catch (error) {
          console.error('Error updating prompt:', error);
          return null;
        }
      }
    };

    // ===== SAVE DIALOG MANAGER =====
    const SaveDialogManager = {
      show(promptContent) {
        const overlay = document.createElement('div');
        overlay.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          backdrop-filter: blur(5px);
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
          background: white;
          border-radius: 16px;
          padding: 32px;
          max-width: 500px;
          width: 90%;
          box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
          transform: scale(0.9);
          transition: transform 0.2s ease;
        `;
        
        dialog.innerHTML = `
          <h2 style="margin: 0 0 24px 0; color: #1e293b; font-size: 24px;">💾 Save Prompt to Library</h2>
          
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Prompt Title</label>
            <input type="text" id="saveDialogTitle" placeholder="Enter a descriptive title..." style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
          </div>
          
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Description</label>
            <textarea id="saveDialogDescription" placeholder="Brief description of what this prompt does..." style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px; height: 80px; resize: vertical;"></textarea>
          </div>
          
          <div style="margin-bottom: 24px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Category</label>
            <select id="saveDialogCategory" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
              <option value="email">Email</option>
              <option value="creative">Creative</option>
              <option value="video">Video</option>
              <option value="social">Social</option>
              <option value="career">Career</option>
              <option value="business">Business</option>
              <option value="custom">Custom</option>
            </select>
          </div>
          
          <div style="display: flex; gap: 12px; justify-content: flex-end;">
            <button id="saveDialogCancel" style="padding: 12px 24px; border: 1px solid #d1d5db; background: white; color: #374151; border-radius: 8px; cursor: pointer; font-weight: 600;">Cancel</button>
            <button id="saveDialogSave" style="padding: 12px 24px; border: none; background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; border-radius: 8px; cursor: pointer; font-weight: 600;">💾 Save Prompt</button>
          </div>
        `;
        
        overlay.appendChild(dialog);
        document.body.appendChild(overlay);
        
        setTimeout(() => {
          dialog.style.transform = 'scale(1)';
        }, 10);
        
        const titleInput = dialog.querySelector('#saveDialogTitle');
        titleInput.focus();
        
        dialog.querySelector('#saveDialogSave').addEventListener('click', () => {
          const title = dialog.querySelector('#saveDialogTitle').value.trim();
          const description = dialog.querySelector('#saveDialogDescription').value.trim();
          const category = dialog.querySelector('#saveDialogCategory').value;
          
          if (!title) {
            alert('Please enter a title for your prompt');
            titleInput.focus();
            return;
          }
          
          const savedPrompt = SavedPromptsManager.save({
            title,
            description: description || 'Custom saved prompt',
            category,
            content: promptContent,
            author: 'You'
          });
          
          if (savedPrompt) {
            showCopySuccess('Prompt saved to library!');
            
            if (WorkbenchManager.currentFilter === 'my-library') {
              WorkbenchManager.renderContent('my-library');
            }
          }
          
          document.body.removeChild(overlay);
        });
        
        dialog.querySelector('#saveDialogCancel').addEventListener('click', () => {
          document.body.removeChild(overlay);
        });
        
        const handleEsc = (e) => {
          if (e.key === 'Escape') {
            document.body.removeChild(overlay);
            document.removeEventListener('keydown', handleEsc);
          }
        };
        document.addEventListener('keydown', handleEsc);
        
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) {
            document.body.removeChild(overlay);
          }
        });
      }
    };

    // ===== STARTER PROMPTS DATABASE =====
    const STARTER_PROMPTS = {
      email: [
        {
          id: 'starter_email_001',
          title: 'Cold Email That Gets 30%+ Response Rates',
          content: `You are an expert sales professional who writes personalized cold emails that get responses.

Your task: Write a cold email that gets prospects to respond and start a conversation.

Context: You're reaching out to [TARGET AUDIENCE] who struggle with [SPECIFIC PAIN POINT]. Research shows they're currently using [CURRENT SOLUTION] but facing challenges with [SPECIFIC CHALLENGE].

Tone and style: Professional but approachable, helpful colleague who understands their challenges

Important constraints: Keep under 150 words, include a clear call-to-action, personalize with specific details about their business

Examples of desired output:
Subject: Quick question about [SPECIFIC CHALLENGE] at [COMPANY]
Hi [NAME], Noticed [SPECIFIC OBSERVATION]. Quick question about [CHALLENGE] - have 30 seconds for a brief response? [CTA]

Please provide your response following all the above guidelines and requirements.`,
          category: 'email',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_email_002',
          title: 'Follow-up Email That Converts',
          content: `You are a professional email marketing strategist who creates follow-up sequences that convert leads into customers.

Your task: Write a follow-up email that nurtures the relationship and drives the prospect to take the next step.

Context: This prospect has already engaged with you (opened email, visited website, downloaded content, or attended webinar). They know who you are but haven't committed yet.

Tone and style: Confident but helpful, you've earned the right to be more direct while still providing value

Important constraints: Reference the previous interaction, provide additional value, include one clear call-to-action

Examples of desired output:
"Hi [NAME], saw you downloaded our [RESOURCE] - here's the one insight most people miss..."
"Since you attended [WEBINAR], wanted to share the advanced strategy we couldn't cover..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'email',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_email_003',
          title: 'Sales Closing Email That Seals Deals',
          content: `You are a sales closing expert who writes emails that overcome objections and close deals.

Your task: Write a closing email that addresses concerns and motivates prospects to make a buying decision.

Context: Prospect has shown strong interest but hasn't committed. Common objections include [PRICE/TIMING/AUTHORITY]. Decision timeline is [TIMEFRAME]. Competition includes [ALTERNATIVES].

Tone and style: Confident and consultative, trusted advisor who understands their business needs

Important constraints: Address specific objections, create urgency without pressure, include risk reversal, clear next steps

Examples of desired output:
"Hi [NAME], understand you need to [CONSIDER BUDGET/TIMING]. Here's how [SOLUTION] pays for itself in [TIMEFRAME]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'email',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_email_004',
          title: 'Re-engagement Email That Wins Back Customers',
          content: `You are a customer retention specialist who creates emails that win back inactive customers.

Your task: Write a re-engagement email that brings inactive customers back to your product or service.

Context: Customer hasn't engaged in [TIMEFRAME]. They previously [USED PRODUCT/PURCHASED/ENGAGED]. Likely reasons for leaving include [PAIN POINTS]. New features/improvements include [UPDATES].

Tone and style: Warm and understanding, friend who genuinely wants to help rather than pushy salesperson

Important constraints: Acknowledge the absence, highlight improvements, offer incentive, make return easy

Examples of desired output:
"Hi [NAME], noticed you haven't [SPECIFIC ACTION] in a while. We've made some changes you might find interesting..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'email',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_email_005',
          title: 'Partnership Proposal Email',
          content: `You are a business development expert who creates partnership proposals that generate mutual opportunities.

Your task: Write a partnership proposal email that presents a compelling collaboration opportunity.

Context: Potential partner has [COMPLEMENTARY BUSINESS/AUDIENCE/EXPERTISE]. Mutual benefits include [SHARED GOALS]. Proposed collaboration is [PARTNERSHIP TYPE]. Success metrics would be [MEASURABLE OUTCOMES].

Tone and style: Professional and strategic, equal partner proposing mutual value rather than vendor seeking favor

Important constraints: Focus on mutual benefits, provide specific collaboration ideas, suggest low-risk starting point

Examples of desired output:
"Hi [NAME], noticed your work with [AUDIENCE]. Believe there's an opportunity for [MUTUAL BENEFIT]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'email',
          rating: 4,
          author: 'ThinkPrompt Team'
        }
      ],
      creative: [
        {
          id: 'starter_creative_001',
          title: 'Blog Post That Ranks #1 on Google',
          content: `You are a content marketing expert who creates blog posts that rank well in search and engage readers.

Your task: Write a comprehensive blog post that provides exceptional value while optimizing for search engines.

Context: Target keyword is [KEYWORD] with search intent [INFORMATIONAL/COMMERCIAL/NAVIGATIONAL]. Audience expertise level is [BEGINNER/INTERMEDIATE/ADVANCED]. Competition analysis shows gaps in [SPECIFIC AREAS].

Tone and style: Authoritative but accessible, knowledgeable guide sharing expertise rather than academic lecture

Important constraints: 1500-3000 words, include actionable steps, use headers for scannability, include examples, natural keyword integration, clear call-to-action

Examples of desired output:
"Most people think [COMMON BELIEF] about [TOPIC]. After analyzing [DATA], here's what actually works..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'creative',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_creative_002',
          title: 'Product Copy That Converts Browsers to Buyers',
          content: `You are a conversion copywriter who writes product descriptions and sales copy that drives purchases.

Your task: Write persuasive product copy that highlights benefits and overcomes buying objections.

Context: Product is [PRODUCT TYPE] for [TARGET CUSTOMER]. Price point is [PRICE RANGE]. Main benefits are [KEY BENEFITS]. Common objections include [CONCERNS]. Competitors offer [ALTERNATIVES].

Tone and style: Enthusiastic but credible, excited customer sharing discovery rather than pushy salesperson

Important constraints: Focus on benefits over features, address objections, include social proof, clear call-to-action

Examples of desired output:
"Imagine [DESIRED OUTCOME] in just [TIMEFRAME]. Here's how [PRODUCT] makes it possible..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'creative',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_creative_003',
          title: 'Story That Captivates and Converts',
          content: `You are a master storyteller who creates narratives that engage emotions and drive action.

Your task: Write a compelling story that connects with your audience and motivates them toward a specific outcome.

Context: Story purpose is [BRAND/LESSON/ENTERTAINMENT]. Target audience is [DEMOGRAPHICS/PSYCHOGRAPHICS]. Key message is [CORE THEME]. Desired action is [GOAL].

Tone and style: Engaging and authentic, skilled storyteller who understands human psychology

Important constraints: Clear story arc, emotional connection, relevant to audience, natural integration of message

Examples of desired output:
"Sarah stared at her inbox. 247 unread emails. Sound familiar? Here's how she went from overwhelmed to organized in just one week..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'creative',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_creative_004',
          title: 'Ad Campaign That Stops the Scroll',
          content: `You are an advertising creative director who develops campaigns that capture attention and drive measurable results.

Your task: Create advertising copy that breaks through noise and compels target audience to take action.

Context: Advertising on [PLATFORM]. Target audience is [SPECIFIC DEMOGRAPHICS]. Campaign goal is [AWARENESS/CONVERSION/RETENTION]. Budget is [RANGE]. Competition includes [COMPETITORS].

Tone and style: Bold and attention-grabbing, creative that understands platform behavior and audience psychology

Important constraints: Platform-specific format, thumb-stopping creative, clear value proposition, strong call-to-action

Examples of desired output:
"[SHOCKING STATISTIC] that will change how you think about [TOPIC]..." or "The [SOLUTION] that [COMPETITOR] doesn't want you to know about..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'creative',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_creative_005',
          title: 'Newsletter That People Actually Read',
          content: `You are a newsletter strategist who creates content that subscribers eagerly anticipate and engage with.

Your task: Write newsletter content that provides consistent value and builds long-term subscriber relationships.

Context: Newsletter frequency is [WEEKLY/MONTHLY]. Audience is [PROFESSIONAL/CONSUMER]. Topics include [SUBJECT AREAS]. Open rates currently [BENCHMARK]. Goal is [ENGAGEMENT/GROWTH/REVENUE].

Tone and style: Conversational and valuable, trusted friend sharing interesting discoveries rather than corporate announcement

Important constraints: Scannable format, mix of content types, clear value in each section, engaging subject line

Examples of desired output:
"3 things I learned this week that changed my perspective on [TOPIC]..." or "The tool everyone's talking about (and why I'm not convinced)..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'creative',
          rating: 4,
          author: 'ThinkPrompt Team'
        }
      ],
      video: [
        {
          id: 'starter_video_001',
          title: 'YouTube Script That Keeps 80%+ Viewers',
          content: `You are an experienced YouTube content creator who understands how to structure videos for maximum engagement and subscriber growth.

Your task: Write a YouTube video script that captures attention immediately and maintains engagement throughout.

Context: Video topic is [TOPIC] targeting [AUDIENCE]. Video length is [DURATION]. Audience knowledge level is [BEGINNER/INTERMEDIATE/ADVANCED]. Goal is [EDUCATE/ENTERTAIN/CONVERT].

Tone and style: [HIGH-ENERGY/CALM/CONVERSATIONAL] and engaging, authentic personality that keeps viewers watching while delivering value

Important constraints: Hook in first 15 seconds, clear value proposition, include pattern interrupts, call-to-action for subscribe/like, maintain pacing throughout

Examples of desired output:
"In the next 8 minutes, I'll show you the [TECHNIQUE] that [OUTCOME] - but first, this one mistake kills most people's results..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'video',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_video_002',
          title: 'TikTok Script That Goes Viral',
          content: `You are a TikTok content creator who understands viral trends and creates engaging short-form content.

Your task: Write a TikTok video script that stops scroll and drives engagement.

Context: Using [TRENDING SOUND/FORMAT]. Target audience is [DEMOGRAPHICS]. Content angle is [EDUCATIONAL/ENTERTAINING/BEHIND-SCENES]. Current trending topics include [TRENDS].

Tone and style: Authentic and entertaining, friend sharing something cool rather than polished advertisement

Important constraints: Hook in first 3 seconds, 15-60 seconds total, include trending elements, text overlay opportunities, shareable moment

Examples of desired output:
"POV: You just learned [SURPRISING FACT] and now you can't unsee it everywhere... *shows examples*"

Please provide your response following all the above guidelines and requirements.`,
          category: 'video',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_video_003',
          title: 'Tutorial Video That Actually Teaches',
          content: `You are an educational content creator who breaks down complex topics into digestible, actionable lessons.

Your task: Create a tutorial video script that teaches a skill clearly and enables viewers to succeed.

Context: Teaching [SKILL/TOPIC] to [AUDIENCE LEVEL]. Common struggles include [PAIN POINTS]. Available tools/resources are [REQUIREMENTS]. Expected outcome is [GOAL].

Tone and style: Patient and encouraging, helpful teacher who wants students to succeed rather than expert showing off knowledge

Important constraints: Clear step-by-step structure, anticipate common mistakes, provide checkpoints, include troubleshooting, actionable outcome

Examples of desired output:
"By the end of this video, you'll be able to [SPECIFIC OUTCOME]. We'll start with [STEP 1] - and don't worry if you get stuck, I'll show you exactly how to fix the most common issue..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'video',
          rating: 5,
          author: 'ThinkPrompt Team'
        }
      ],
      social: [
        {
          id: 'starter_social_001',
          title: 'LinkedIn Post That Builds Authority',
          content: `You are a LinkedIn content strategist who helps professionals build their personal brand and generate business opportunities.

Your task: Write a LinkedIn post that demonstrates expertise while encouraging professional engagement.

Context: You're a [YOUR PROFESSION] sharing insights about [INDUSTRY TOPIC]. Your network includes [AUDIENCE TYPES]. Current industry challenges include [PAIN POINTS]. Your unique perspective is [ANGLE].

Tone and style: Professional but personable, industry expert sharing valuable insights rather than formal corporate announcement

Important constraints: Professional value, personal story elements, industry relevance, engagement hook, clear point of view, call for discussion

Examples of desired output:
"After 10 years in [INDUSTRY], I've noticed most companies make this one critical mistake with [TOPIC]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'social',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_social_002',
          title: 'Instagram Post That Drives Engagement',
          content: `You are an Instagram content creator who builds engaged communities and drives meaningful interactions.

Your task: Create Instagram content that stops the scroll and encourages authentic engagement.

Context: Account focuses on [NICHE/TOPIC]. Audience is [DEMOGRAPHICS]. Current engagement rate is [BENCHMARK]. Content pillars include [THEMES]. Platform trends include [CURRENT TRENDS].

Tone and style: Authentic and relatable, friend sharing valuable experiences rather than polished influencer

Important constraints: Visual storytelling, engaging caption, relevant hashtags, call for engagement, authentic voice

Examples of desired output:
"POV: You finally figure out [COMMON STRUGGLE] and everything clicks... Here's what I wish I knew sooner 👇"

Please provide your response following all the above guidelines and requirements.`,
          category: 'social',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_social_003',
          title: 'Twitter Thread That Goes Viral',
          content: `You are a Twitter content strategist who creates threads that educate, engage, and expand reach.

Your task: Write a Twitter thread that provides value and encourages retweets and follows.

Context: Thread topic is [SUBJECT]. Target audience includes [AUDIENCE TYPES]. Thread length should be [TWEET COUNT]. Goal is [EDUCATION/ENGAGEMENT/GROWTH]. Current trends include [RELEVANT TOPICS].

Tone and style: Informative and engaging, knowledgeable person sharing valuable insights in digestible format

Important constraints: Hook in first tweet, valuable information, logical flow, retweet-worthy insights, engagement prompts

Examples of desired output:
"🧵 Thread: The [NUMBER] mistakes that kill [OUTCOME] (and how to avoid them)
1/ Most people think [MISCONCEPTION]. Here's what actually happens..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'social',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_social_004',
          title: 'TikTok Video Script That Gets Views',
          content: `You are a TikTok content creator who understands viral mechanics and creates engaging short-form videos.

Your task: Write a TikTok video script that captures attention and drives engagement.

Context: Video topic is [SUBJECT]. Target audience is [AGE/INTERESTS]. Video format is [EDUCATIONAL/ENTERTAINMENT/BEHIND-SCENES]. Trending sounds include [AUDIO OPTIONS]. Goal is [VIEWS/FOLLOWS/ENGAGEMENT].

Tone and style: Energetic and authentic, friend sharing something cool rather than professional presenter

Important constraints: Hook in first 3 seconds, maintain attention throughout, include trending elements, clear value or entertainment

Examples of desired output:
"Wait... did you know [SURPRISING FACT]? I had no idea until [DISCOVERY MOMENT] 👀 *shows evidence*"

Please provide your response following all the above guidelines and requirements.`,
          category: 'social',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_social_005',
          title: 'Facebook Ad That Converts Cold Traffic',
          content: `You are a Facebook advertising specialist who creates ads that turn cold audiences into customers.

Your task: Write Facebook ad copy that captures attention and drives conversions from people unfamiliar with your brand.

Context: Product/service is [OFFERING]. Target audience is [DEMOGRAPHICS/INTERESTS]. Ad objective is [CONVERSION GOAL]. Budget is [DAILY/CAMPAIGN]. Competition includes [COMPETITORS].

Tone and style: Conversational and compelling, helpful friend recommending solution rather than obvious advertisement

Important constraints: Attention-grabbing opener, clear benefit, social proof, urgency/scarcity, strong call-to-action

Examples of desired output:
"[RELATABLE PROBLEM]? Here's the [SOLUTION] that [SOCIAL PROOF] are using to [DESIRED OUTCOME]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'social',
          rating: 5,
          author: 'ThinkPrompt Team'
        }
      ],
      career: [
        {
          id: 'starter_career_001',
          title: 'Resume Summary That Gets Interviews',
          content: `You are a career coach and resume expert who helps professionals create summaries that get interviews.

Your task: Write a professional summary that makes recruiters want to learn more about this candidate.

Context: Target role is [SPECIFIC POSITION] in [INDUSTRY]. Candidate has [X] years experience in [FIELD]. Key achievements include [ACCOMPLISHMENTS]. Career level is [ENTRY/MID/SENIOR/EXECUTIVE].

Tone and style: Confident and professional, accomplished professional highlighting achievements rather than modest person downplaying skills

Important constraints: 3-4 sentences, quantified achievements, relevant keywords, value proposition clear, ATS-friendly language

Examples of desired output:
"Marketing professional with 5+ years driving [X]% revenue growth through data-driven campaigns. Led [ACHIEVEMENT] resulting in [OUTCOME]. Expertise in [SKILLS] with proven track record of [RESULTS]."

Please provide your response following all the above guidelines and requirements.`,
          category: 'career',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_career_002',
          title: 'Cover Letter That Opens Doors',
          content: `You are a career strategist who writes cover letters that get candidates noticed and invited for interviews.

Your task: Write a personalized cover letter that connects candidate experience to specific job requirements.

Context: Job posting emphasizes [KEY REQUIREMENTS]. Company culture values [COMPANY VALUES]. Candidate's relevant experience includes [BACKGROUND]. Career transition involves [CHANGE TYPE]. Hiring manager likely cares about [PRIORITIES].

Tone and style: Professional yet personable, qualified candidate who understands the role and company

Important constraints: Address hiring manager by name, reference specific job requirements, highlight relevant achievements, show company research

Examples of desired output:
"Dear [HIRING MANAGER], Your recent posting for [POSITION] caught my attention because of [SPECIFIC DETAIL]. In my [X] years at [COMPANY], I [RELEVANT ACHIEVEMENT]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'career',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_career_003',
          title: 'LinkedIn Profile That Attracts Recruiters',
          content: `You are a personal branding expert who optimizes LinkedIn profiles to attract opportunities and build professional networks.

Your task: Create LinkedIn profile content that improves visibility and attracts the right professional opportunities.

Context: Professional is [CURRENT ROLE] seeking [TARGET OPPORTUNITIES]. Industry is [SECTOR]. Career goals include [OBJECTIVES]. Key skills are [COMPETENCIES]. Target audience includes [RECRUITERS/CLIENTS/PEERS].

Tone and style: Professional and approachable, accomplished expert who is confident but accessible

Important constraints: Keyword optimization, achievement focus, industry relevance, clear value proposition, engaging personality

Examples of desired output:
"[TITLE] helping [TARGET AUDIENCE] achieve [OUTCOME] through [METHODOLOGY]. [X]+ years transforming [SPECIFIC AREA] with proven results in [ACHIEVEMENTS]."

Please provide your response following all the above guidelines and requirements.`,
          category: 'career',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_career_004',
          title: 'Interview Answers That Win Job Offers',
          content: `You are an interview coach who helps candidates prepare compelling responses that demonstrate qualifications and cultural fit.

Your task: Create structured interview responses using proven frameworks that showcase qualifications effectively.

Context: Interview is for [POSITION] at [COMPANY TYPE]. Key competencies being assessed include [SKILLS/QUALITIES]. Common questions include [QUESTION TYPES]. Candidate's background includes [EXPERIENCE]. Interview format is [STYLE].

Tone and style: Confident and articulate, qualified candidate who can clearly communicate value while showing authentic personality

Important constraints: Use STAR method (Situation, Task, Action, Result), provide specific examples, quantify achievements, show growth mindset, demonstrate cultural fit

Examples of desired output:
"When asked about leadership: 'In my role as [POSITION], I faced [SITUATION]. My task was to [RESPONSIBILITY]. I took action by [SPECIFIC STEPS] which resulted in [QUANTIFIED OUTCOME]. This taught me [LEARNING]...'"

Please provide your response following all the above guidelines and requirements.`,
          category: 'career',
          rating: 4,
          author: 'ThinkPrompt Team'
        }
      ],
      business: [
        {
          id: 'starter_business_001',
          title: 'Business Plan That Secures Funding',
          content: `You are a business strategy consultant who helps entrepreneurs create business plans that secure funding and partnerships.

Your task: Write an executive summary that makes investors want to learn more about your business opportunity.

Context: Business is [BUSINESS TYPE] solving [PROBLEM] for [TARGET MARKET]. Market size is [TAM/SAM]. Business model is [REVENUE MODEL]. Competitive advantage is [DIFFERENTIATOR]. Funding need is [AMOUNT] for [PURPOSE].

Tone and style: Professional and confident, experienced entrepreneur with proven opportunity rather than hopeful startup with untested idea

Important constraints: 1-2 pages maximum, clear problem/solution fit, market opportunity size, competitive advantage, financial projections, funding use, team credibility

Examples of desired output:
"[COMPANY] addresses the $[X]B market opportunity in [SECTOR] by [SOLUTION]. Our proven model generates [REVENUE] with [MARGIN]% margins. Seeking $[AMOUNT] to [OBJECTIVE]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'business',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_business_002',
          title: 'Market Research Report That Guides Strategy',
          content: `You are a market research analyst who provides insights that help businesses make informed strategic decisions.

Your task: Create a comprehensive market analysis that informs strategic business decisions with actionable insights.

Context: Research focuses on [INDUSTRY/MARKET]. Key questions include [RESEARCH OBJECTIVES]. Available data sources are [DATA TYPES]. Target audience for report is [EXECUTIVES/MANAGERS/INVESTORS]. Decision timeline is [TIMEFRAME].

Tone and style: Analytical and objective, expert researcher presenting data-driven insights rather than opinion-based recommendations

Important constraints: Executive summary first, data-driven conclusions, visual data presentation, actionable recommendations, risk assessment, competitive landscape

Examples of desired output:
"Market analysis reveals [KEY FINDING] with [X]% growth projected over [TIMEFRAME]. Primary drivers include [FACTORS]. Recommended strategy: [APPROACH]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'business',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_business_003',
          title: 'Proposal That Wins New Business',
          content: `You are a business development specialist who writes proposals that win contracts and close deals.

Your task: Create a compelling business proposal that demonstrates value and wins the contract.

Context: Client needs [SPECIFIC REQUIREMENTS]. Project scope includes [DELIVERABLES]. Timeline is [DURATION]. Budget range is [AMOUNT]. Competition includes [COMPETITORS]. Client priorities are [KEY CONCERNS].

Tone and style: Professional and solution-focused, trusted partner who understands client needs rather than vendor pushing services

Important constraints: Address client pain points, demonstrate understanding, clear deliverables, realistic timeline, competitive pricing, proof of capability

Examples of desired output:
"Based on your need for [REQUIREMENT], we propose [SOLUTION] that delivers [OUTCOME] within [TIMELINE]. Our approach includes [METHODOLOGY]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'business',
          rating: 5,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_business_004',
          title: 'Strategic Plan That Drives Growth',
          content: `You are a strategic planning consultant who helps organizations develop clear roadmaps for sustainable growth and competitive advantage.

Your task: Create a strategic plan that provides clear direction and actionable steps for organizational growth.

Context: Organization is [COMPANY TYPE] in [INDUSTRY]. Current challenges include [OBSTACLES]. Growth goals are [OBJECTIVES]. Timeline is [DURATION]. Available resources include [BUDGET/TEAM]. Market conditions include [ENVIRONMENT].

Tone and style: Strategic and forward-thinking, experienced advisor who balances ambition with pragmatism

Important constraints: Clear vision statement, SWOT analysis, specific goals with metrics, resource allocation, risk mitigation, implementation timeline

Examples of desired output:
"Strategic vision: [VISION STATEMENT]. Based on market analysis, we recommend focusing on [PRIORITIES] to achieve [X]% growth within [TIMEFRAME] through [STRATEGIES]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'business',
          rating: 4,
          author: 'ThinkPrompt Team'
        },
        {
          id: 'starter_business_005',
          title: 'Pitch Deck That Gets Investor Meetings',
          content: `You are a startup advisor who helps entrepreneurs create pitch decks that capture investor attention and secure funding meetings.

Your task: Write compelling pitch deck content that tells a persuasive story and motivates investors to learn more.

Context: Startup is [BUSINESS TYPE] in [SECTOR]. Problem being solved is [PAIN POINT]. Solution is [PRODUCT/SERVICE]. Target market is [AUDIENCE]. Traction includes [METRICS]. Funding round is [SERIES/AMOUNT].

Tone and style: Compelling and confident, visionary entrepreneur who understands market opportunity and can execute successfully

Important constraints: 10-12 slide structure, compelling problem/solution narrative, market size validation, business model clarity, team credibility, clear ask

Examples of desired output:
"Problem: [X MILLION] people struggle with [PAIN POINT], costing [INDUSTRY] $[AMOUNT] annually. Our solution: [PRODUCT] that [UNIQUE VALUE]. Early traction: [METRICS]..."

Please provide your response following all the above guidelines and requirements.`,
          category: 'business',
          rating: 5,
          author: 'ThinkPrompt Team'
        }
      ]
    };

    // ===== QUALITY MANAGER - HOTFIXED =====
    const QualityManager = {
      assessQuality() {
        const coreFields = ['goal', 'context', 'tone'];
        const optionalFields = ['role', 'format', 'constraints', 'examples'];
        
        let coreCount = 0;
        let optionalCount = 0;

        // Count filled core fields
        coreFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (field && field.value.trim()) {
            coreCount++;
          }
        });

        // Count filled optional fields (only if visible)
        optionalFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (field && field.value.trim()) {
            const fieldGroup = field.closest('#roleGroup, #formatGroup, #constraintsGroup, #examplesGroup');
            
            if (fieldGroup) {
              const isVisible = window.getComputedStyle(fieldGroup).display !== 'none';
              if (isVisible) {
                optionalCount++;
              }
            } else {
              optionalCount++;
            }
          }
        });

        // New 3-level status logic
        if (coreCount < 3) {
          return 'incomplete';
        } else if (coreCount === 3 && optionalCount < 2) {
          return 'ready';
        } else {
          return 'optimized';
        }
      },

      updateDisplay() {
        const quality = this.assessQuality();
        
        // Check for selected template to show template-specific hints
        const selectedTemplate = StateManager.getState().selectedTemplate;
        const defaultMessages = {
          none: "Select template, begin filling out form and the prompt quality assistant will activate",
          incomplete: "Need GOAL + CONTEXT + TONE minimum to generate anything useful",
          ready: "Ready to generate - add examples & constraints for best results", 
          optimized: "Optimized prompt ready - this will give you the best output"
        };

        let messages = defaultMessages;
        
        // Use template-specific hint if available
        if (selectedTemplate && selectedTemplate.qualityHint) {
          messages = {
            none: selectedTemplate.qualityHint,
            incomplete: selectedTemplate.qualityHint,
            ready: "Ready to generate - add examples & constraints for best results",
            optimized: "Optimized prompt ready - this will give you the best output"
          };
        }

        // Update status displays
        this.updateStatusPanels(quality, messages[quality]);
      },

      updateStatusPanels(quality, message) {
        const statusConfigs = {
          none: { icon: '⚪', level: 'WAITING', className: 'status-none' },
          incomplete: { icon: '⚫', level: 'INCOMPLETE', className: 'status-incomplete' },
          ready: { icon: '🟡', level: 'READY TO GENERATE', className: 'status-ready' },
          optimized: { icon: '🟢', level: 'OPTIMIZED PROMPT', className: 'status-optimized' }
        };
        
        const config = statusConfigs[quality] || statusConfigs.none;
        
        // Update top panel
        const topIcon = document.getElementById('statusIcon');
        const topLevel = document.getElementById('statusLevel');
        const topMessage = document.getElementById('statusMessage');
        
        if (topIcon) topIcon.textContent = config.icon;
        if (topLevel) {
          topLevel.textContent = config.level;
          topLevel.className = `status-level ${config.className}`;
        }
        if (topMessage) topMessage.textContent = message;
        
        // Update bottom panel
        const bottomIcon = document.getElementById('statusIconBottom');
        const bottomLevel = document.getElementById('statusLevelBottom'); 
        const bottomMessage = document.getElementById('statusMessageBottom');
        
        if (bottomIcon) bottomIcon.textContent = config.icon;
        if (bottomLevel) {
          bottomLevel.textContent = config.level;
          bottomLevel.className = `status-level ${config.className}`;
        }
        if (bottomMessage) bottomMessage.textContent = message;
      }
    };

    // ===== WORKBENCH MANAGER =====
    const WorkbenchManager = {
      currentFilter: null,
      
      init() {
        this.initializeTabs();
        this.renderWelcomeState();
      },
      
      renderWelcomeState() {
        const container = document.getElementById('workbenchContent');
        container.innerHTML = '';
        
        document.querySelectorAll('.workbench-tab').forEach(tab => {
          tab.classList.remove('active');
        });
      },
      
      switchTab(filter) {
        this.currentFilter = filter;
        this.updateTabUI(filter);
        this.renderContent(filter);
        
        // SURGICAL FIX: Hide all build sections when entering workbench mode
        document.getElementById('templatesSection').classList.remove('show');
        document.getElementById('formSection').classList.remove('show');
        document.getElementById('outputSection').classList.remove('show');
        document.getElementById('qualityPanel').style.display = 'none';
        document.getElementById('qualityPanelBottom').style.display = 'none';
      },
      
      updateTabUI(activeFilter) {
        document.querySelectorAll('.workbench-tab').forEach(tab => {
          if (tab.dataset.filter === activeFilter) {
            tab.classList.add('active');
          } else {
            tab.classList.remove('active');
          }
        });
      },
      
      renderContent(filter) {
        const container = document.getElementById('workbenchContent');
        
        if (filter === 'add-new') {
          this.renderAddNewForm(container);
        } else if (filter === 'my-library') {
          this.renderMyLibrary(container);
        } else {
          this.renderStarterPrompts(container, filter);
        }
      },
      
      renderAddNewForm(container) {
        container.innerHTML = `
          <div class="add-prompt-form">
            <h3 style="color: var(--workbench-color); margin-bottom: 20px; text-align: center;">Add New Prompt</h3>
            <div class="form-group">
              <label for="promptTitle">Title</label>
              <input type="text" id="promptTitle" placeholder="Enter prompt title">
            </div>
            <div class="form-group">
              <label for="promptDescription">Description</label>
              <input type="text" id="promptDescription" placeholder="Brief description">
            </div>
            <div class="form-group">
              <label for="promptCategory">Category</label>
              <select id="promptCategory">
                <option value="email">Email</option>
                <option value="creative">Creative</option>
                <option value="video">Video</option>
                <option value="social">Social</option>
                <option value="career">Career</option>
                <option value="business">Business</option>
              </select>
            </div>
            <div class="form-group">
              <label for="promptText">Prompt Text</label>
              <textarea id="promptText" placeholder="Enter your prompt text here..."></textarea>
            </div>
            <div style="text-align: center;">
              <button class="btn btn-blue" onclick="WorkbenchManager.saveNewPrompt()">
                💾 Save Prompt
              </button>
            </div>
          </div>
        `;
      },
      
      renderMyLibrary(container) {
        const savedPrompts = SavedPromptsManager.getAll();
        
        if (savedPrompts.length === 0) {
          container.innerHTML = `
            <div class="empty-workbench">
              <div class="empty-workbench-icon">📚</div>
              <h3>Your Library is Empty</h3>
              <p>Save prompts from the workbench to build your personal collection</p>
              <button class="btn btn-blue btn-small" onclick="WorkbenchManager.switchTab('add-new')" style="margin-top: 16px;">
                ➕ Add Your First Prompt
              </button>
            </div>
          `;
          return;
        }
        
        this.currentPrompts = {};
        savedPrompts.forEach(prompt => {
          this.currentPrompts[prompt.id] = prompt;
        });
        
        container.innerHTML = `
          <div style="margin-bottom: 20px; text-align: center;">
            <h3 style="color: #1e293b; margin-bottom: 8px;">My Saved Prompts (${savedPrompts.length})</h3>
            <p style="color: #64748b; font-size: 14px;">Your personal collection of saved prompts</p>
            <div style="margin-top: 16px; display: flex; gap: 12px; justify-content: center;">
              <button class="btn btn-secondary btn-small" onclick="WorkbenchManager.exportText()">
                <svg class="icon" viewBox="0 0 24 24" width="12" height="12"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14,2 14,8 20,8"></polyline></svg>
                Export Text
              </button>
              <button class="btn btn-secondary btn-small" onclick="WorkbenchManager.exportCSV()">
                <svg class="icon" viewBox="0 0 24 24" width="12" height="12"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14,2 14,8 20,8"></polyline></svg>
                Export CSV
              </button>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            ${savedPrompts.map(prompt => this.createPromptCard(prompt, true)).join('')}
          </div>
        `;
      },
      
      renderStarterPrompts(container, filter) {
        let allPrompts = [];
        
        Object.values(STARTER_PROMPTS).forEach(categoryPrompts => {
          allPrompts = allPrompts.concat(categoryPrompts);
        });
        
        const filteredPrompts = filter === 'all' 
          ? allPrompts
          : allPrompts.filter(prompt => prompt.category === filter);
        
        if (filteredPrompts.length === 0) {
          container.innerHTML = `
            <div class="empty-workbench">
              <div class="empty-workbench-icon">🔥</div>
              <h3>No prompts found</h3>
              <p>Try a different category or check out "My Library"</p>
            </div>
          `;
          return;
        }
        
        this.currentPrompts = {};
        filteredPrompts.forEach(prompt => {
          this.currentPrompts[prompt.id] = prompt;
        });
        
        container.innerHTML = `
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            ${filteredPrompts.map(prompt => this.createPromptCard(prompt, false)).join('')}
          </div>
        `;
      },
      
      createPromptCard(prompt, isUserPrompt = false) {
        const stars = prompt.rating ? '★'.repeat(prompt.rating) + '☆'.repeat(5 - prompt.rating) : '';
        const safePreview = this.escapeHtml(prompt.content.substring(0, 120)) + '...';
        const safeTitle = this.escapeHtml(prompt.title);
        const safeAuthor = this.escapeHtml(prompt.author || 'You');
        const safeDescription = prompt.description ? this.escapeHtml(prompt.description) : '';
        const safeCategory = prompt.category ? this.escapeHtml(prompt.category) : '';
        const createdDate = prompt.timestamp ? new Date(prompt.timestamp).toLocaleDateString() : '';
        
        return `
          <div class="starter-prompt-item">
            <div class="prompt-item-title">${safeTitle}</div>
            ${stars ? `<div class="prompt-rating">${stars}</div>` : ''}
            ${safeDescription ? `<div style="font-size: 13px; color: #64748b; margin: 6px 0; font-style: italic;">${safeDescription}</div>` : ''}
            ${safeCategory || createdDate ? `<div style="display: flex; gap: 12px; margin: 8px 0; font-size: 12px;">
              ${safeCategory ? `<span style="background: #f1f5f9; color: #475569; padding: 2px 8px; border-radius: 12px; text-transform: capitalize;">${safeCategory}</span>` : ''}
              ${createdDate ? `<span style="color: #94a3b8;">Created: ${createdDate}</span>` : ''}
            </div>` : ''}
            <div class="prompt-item-preview">${safePreview}</div>
            <div class="prompt-item-actions">
              <button class="btn btn-secondary btn-small" onclick="WorkbenchManager.usePromptById('${prompt.id}')">
                <svg class="icon" viewBox="0 0 24 24" width="12" height="12"><path d="M7 7h10v10"></path><path d="M7 17 17 7"></path></svg>
                Use
              </button>
              <button class="btn btn-blue btn-small" onclick="WorkbenchManager.copyPromptById('${prompt.id}')">
                <svg class="icon" viewBox="0 0 24 24" width="12" height="12"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="m4 16c-1.1 0-2-.9-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>
                Copy
              </button>
              ${isUserPrompt ? `<button class="btn btn-secondary btn-small" onclick="WorkbenchManager.deletePrompt('${prompt.id}')" style="background: #dc2626; color: white;">🗑️</button>` : ''}
            </div>
          </div>
        `;
      },
      
      escapeHtml(unsafe) {
        return unsafe
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      },
      
      usePromptById(promptId) {
        const prompt = this.findPromptById(promptId);
        if (prompt) {
          document.getElementById('outputTextarea').value = prompt.content;
          document.getElementById('outputSection').classList.add('show');
          setTimeout(() => {
            document.querySelector('.output-section').scrollIntoView({ behavior: 'smooth' });
          }, 100);
        }
      },
      
      copyPromptById(promptId) {
        const prompt = this.findPromptById(promptId);
        if (prompt) {
          navigator.clipboard.writeText(prompt.content).then(() => {
            showCopySuccess('Copied to clipboard!');
          });
        }
      },
      
      findPromptById(promptId) {
        if (this.currentPrompts && this.currentPrompts[promptId]) {
          return this.currentPrompts[promptId];
        }
        
        for (const category of Object.values(STARTER_PROMPTS)) {
          const prompt = category.find(p => p.id === promptId);
          if (prompt) return prompt;
        }
        
        const savedPrompts = SavedPromptsManager.getAll();
        const prompt = savedPrompts.find(p => p.id == promptId);
        if (prompt) return prompt;
        
        return null;
      },
      
      deletePrompt(promptId) {
        if (confirm('Are you sure you want to delete this prompt? This action cannot be undone.')) {
          if (SavedPromptsManager.delete(promptId)) {
            if (WorkbenchManager.currentFilter === 'my-library') {
              WorkbenchManager.renderContent('my-library');
            }
          } else {
            alert('Error deleting prompt. Please try again.');
          }
        }
      },
      
      initializeTabs() {
        document.querySelectorAll('.workbench-tab').forEach(tab => {
          tab.addEventListener('click', (e) => {
            const filter = e.target.dataset.filter;
            this.switchTab(filter);
          });
        });
      },
      
      saveNewPrompt() {
        const title = document.getElementById('promptTitle').value.trim();
        const description = document.getElementById('promptDescription').value.trim();
        const category = document.getElementById('promptCategory').value;
        const content = document.getElementById('promptText').value.trim();
        
        if (!title || !description || !content) {
          alert('Please fill in all fields');
          return;
        }
        
        const savedPrompt = SavedPromptsManager.save({
          title,
          description,
          category,
          content,
          author: 'You'
        });
        
        if (savedPrompt) {
          const form = document.querySelector('.add-prompt-form');
          const existingSuccess = form.querySelector('.success-message');
          if (existingSuccess) existingSuccess.remove();
          
          form.insertAdjacentHTML('afterbegin', '<div class="success-message" style="background: #10b981; color: white; padding: 12px; border-radius: 8px; margin-bottom: 15px; text-align: center;">✅ Prompt saved successfully!</div>');
          
          document.getElementById('promptTitle').value = '';
          document.getElementById('promptDescription').value = '';
          document.getElementById('promptText').value = '';
          
          setTimeout(() => {
            const successMsg = form.querySelector('.success-message');
            if (successMsg) successMsg.remove();
          }, 3000);
        } else {
          alert('Error saving prompt. Please try again.');
        }
      },
      
      exportText() {
        const savedPrompts = SavedPromptsManager.getAll();
        
        if (savedPrompts.length === 0) {
          alert('No prompts to export. Save some prompts first!');
          return;
        }
        
        let textContent = 'ThinkPrompt - My Saved Prompts\n';
        textContent += '====================================\n\n';
        
        savedPrompts.forEach((prompt, index) => {
          const date = new Date(prompt.timestamp).toLocaleDateString();
          textContent += `${index + 1}. ${prompt.title}\n`;
          textContent += `Category: ${prompt.category}\n`;
          textContent += `Created: ${date}\n`;
          textContent += `Content:\n${prompt.content}\n\n`;
          textContent += '------------------------------------\n\n';
        });
        
        const blob = new Blob([textContent], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `thinkprompt-prompts-${new Date().toISOString().split('T')[0]}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showCopySuccess('Text file exported successfully!');
      },
      
      exportCSV() {
        const savedPrompts = SavedPromptsManager.getAll();
        
        if (savedPrompts.length === 0) {
          alert('No prompts to export. Save some prompts first!');
          return;
        }
        
        // CSV Header
        let csvContent = 'Title,Category,Content,Date Created\n';
        
        // CSV Rows
        savedPrompts.forEach(prompt => {
          const date = new Date(prompt.timestamp).toLocaleDateString();
          const title = `"${prompt.title.replace(/"/g, '""')}"`;
          const category = `"${prompt.category}"`;
          const content = `"${prompt.content.replace(/"/g, '""')}"`;
          const dateCreated = `"${date}"`;
          
          csvContent += `${title},${category},${content},${dateCreated}\n`;
        });
        
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `thinkprompt-prompts-${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showCopySuccess('CSV file exported successfully!');
      }
    };

    // ===== STATE MANAGER =====
    const StateManager = {
      state: {
        currentCategory: null,
        selectedTemplate: null,
        currentPrompt: ''
      },
      
      setCategory(category) {
        this.state.currentCategory = category;
      },
      
      setTemplate(template) {
        this.state.selectedTemplate = template;
      },
      
      setPrompt(prompt) {
        this.state.currentPrompt = prompt;
      },
      
      getState() {
        return this.state;
      },
      
      clearState() {
        this.state = {
          currentCategory: null,
          selectedTemplate: null,
          currentPrompt: ''
        };
      }
    };

    // ===== FIELD MANAGER =====
    const FieldManager = {
      showFields(fieldIds) {
        fieldIds.forEach(id => {
          const element = document.getElementById(id);
          if (element) element.style.display = 'block';
        });
      },
      
      hideFields(fieldIds) {
        fieldIds.forEach(id => {
          const element = document.getElementById(id);
          if (element) element.style.display = 'none';
        });
      },
      
      showAllFields() {
        this.showFields(['roleGroup', 'formatGroup', 'constraintsGroup', 'examplesGroup']);
      },
      
      hideAllFields() {
        this.hideFields(['roleGroup', 'formatGroup', 'constraintsGroup', 'examplesGroup']);
      }
    };

    // ===== FORM MANAGER =====
    const FormManager = {
      clearAll() {
        const fields = ['goal', 'context', 'tone', 'role', 'format', 'constraints', 'examples'];
        fields.forEach(id => {
          const element = document.getElementById(id);
          if (element) element.value = '';
        });
      },
      
      getFormData() {
        return {
          goal: document.getElementById('goal').value.trim(),
          context: document.getElementById('context').value.trim(),
          tone: document.getElementById('tone').value.trim(),
          role: document.getElementById('role').value.trim(),
          format: document.getElementById('format').value.trim(),
          constraints: document.getElementById('constraints').value.trim(),
          examples: document.getElementById('examples').value.trim()
        };
      },
      
      validateRequired() {
        const data = this.getFormData();
        return data.goal.length > 0 && data.context.length > 0 && data.tone.length > 0;
      },
      
      show() {
        document.getElementById('formSection').classList.add('show');
        document.getElementById('qualityPanel').style.display = 'block';
        document.getElementById('qualityPanelBottom').style.display = 'block';
      },
      
      hide() {
        document.getElementById('formSection').classList.remove('show');
        document.getElementById('qualityPanel').style.display = 'none';
        document.getElementById('qualityPanelBottom').style.display = 'none';
      }
    };

    // ===== TEMPLATE MANAGER =====
    const TemplateManager = {
      select(templateKey) {
        const { currentCategory } = StateManager.getState();
        if (currentCategory && templateData[currentCategory]) {
          const currentTemplate = StateManager.getState().selectedTemplate;
          const newTemplate = templateData[currentCategory][templateKey];
          
          // Clear fields when switching to different template
          const isTemplateChange = currentTemplate && currentTemplate.name !== newTemplate.name;
          
          if (isTemplateChange) {
            FormManager.clearAll(); // Fresh start for different template
          } else {
            TemplatePersistence.save(); // Save current work
          }
          
          StateManager.setTemplate(newTemplate);
          this.updateUI(templateKey);
          
          if (!isTemplateChange) {
            setTimeout(() => {
              TemplatePersistence.load(); // Only load if same template
            }, 100);
          }
        }
      },
      
      renderForCategory(category) {
        const templatesSection = document.getElementById('templatesSection');
        const categoryTemplates = templateData[category] || {};
        const templateKeys = Object.keys(categoryTemplates);
        
        const categoryNames = {
          email: 'EMAIL TEMPLATES',
          creative: 'CREATIVE TEMPLATES',
          video: 'VIDEO TEMPLATES',
          social: 'SOCIAL MEDIA TEMPLATES',
          career: 'CAREER TEMPLATES',
          business: 'BUSINESS TEMPLATES'
        };
        
        templatesSection.innerHTML = `
          <div class="templates-header">
            <h3 class="templates-title">${categoryNames[category] || 'TEMPLATES'}</h3>
          </div>
          <div class="templates-content">
            <div class="templates-grid">
              ${templateKeys.map(templateKey => {
                const template = categoryTemplates[templateKey];
                return `
                  <div class="template-card" onclick="selectTemplate('${templateKey}')" data-template="${templateKey}">
                    <div class="template-name">${template.name}</div>
                    <div class="template-desc">${template.description}</div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      },
      
      updateUI(templateKey) {
        document.querySelectorAll('.template-card').forEach(card => {
          card.classList.remove('selected');
        });
        
        const selectedCard = document.querySelector(`[data-template="${templateKey}"]`);
        if (selectedCard) {
          selectedCard.classList.add('selected');
        }
      },
      
      getTemplate() {
        return StateManager.getState().selectedTemplate;
      },
      
      showCustomMode() {
        const templatesSection = document.getElementById('templatesSection');
        templatesSection.innerHTML = `
          <div class="templates-header">
            <h3 class="templates-title">CUSTOM TEMPLATES</h3>
          </div>
          <div class="templates-content">
            <div class="templates-grid">
              <div class="template-card selected">
                <div class="template-name">Build From Scratch</div>
                <div class="template-desc">Build a completely custom prompt with full control over every element. All form fields below are available for your use.</div>
              </div>
            </div>
          </div>
        `;
      }
    };

    // ===== TEMPLATE DATA - HOTFIXED FROM RESTORED =====
    const templateData = {
      email: {
        cold_outreach: {
          name: "Cold Outreach Email",
          description: "Personalized cold emails that get responses and start meaningful business conversations",
          role: "You are an expert cold email strategist who helps professionals create personalized outreach that gets responses."
        },
        follow_up_sequence: {
          name: "Follow-up Email Sequence",
          description: "Multi-touch email sequences that nurture leads and drive conversions over time",
          role: "You are a professional email marketing strategist who specializes in creating follow-up sequences that convert leads into customers."
        },
        meeting_request: {
          name: "Meeting Request Email",
          description: "Professional meeting requests with clear agendas and scheduling options",
          role: "You are a professional meeting coordinator who creates clear, respectful meeting requests that make it easy for people to say yes."
        },
        sales_pitch: {
          name: "Sales Pitch Email",
          description: "Persuasive sales emails that convert prospects into customers",
          role: "You are a sales conversion expert who writes compelling pitch emails that drive revenue."
        },
        newsletter: {
          name: "Newsletter Content",
          description: "Engaging newsletter content that builds audience and drives action",
          role: "You are a newsletter specialist who creates content that subscribers eagerly open and share."
        },
        customer_support: {
          name: "Customer Support Email",
          description: "Professional support emails that resolve issues and maintain relationships",
          role: "You are a customer service expert who turns support interactions into positive experiences."
        }
      },
      creative: {
        story_starter: {
          name: "Story Starter",
          description: "Compelling story openings that hook readers and establish engaging narratives",
          role: "You are a master storyteller who creates compelling opening scenes that immediately hook readers and establish engaging narratives."
        },
        character_development: {
          name: "Character Development",
          description: "Rich character profiles with depth, motivation, and growth potential",
          role: "You are a character development expert who creates complex, believable characters with rich backstories and clear motivations."
        },
        blog_post: {
          name: "Blog Post",
          description: "Engaging blog posts that inform, entertain, and drive traffic",
          role: "You are a content marketing expert who creates blog posts that rank well in search and engage readers."
        },
        social_media_caption: {
          name: "Social Media Caption",
          description: "Engaging captions that drive interaction and build community",
          role: "You are a social media strategist who creates captions that spark conversations and build engaged communities."
        },
        product_description: {
          name: "Product Description",
          description: "Compelling product descriptions that convert browsers into buyers",
          role: "You are a copywriting expert who writes product descriptions that highlight benefits and drive conversions."
        },
        creative_brief: {
          name: "Creative Brief",
          description: "Clear creative briefs that guide design and content teams",
          role: "You are a creative director who writes briefs that inspire great work and align teams."
        }
      },
      video: {
        youtube_script: {
          name: "YouTube Video Script",
          description: "Engaging YouTube scripts that capture attention and drive viewer engagement",
          role: "You are an experienced YouTube content creator who understands how to structure videos for maximum engagement and subscriber growth."
        },
        tiktok_script: {
          name: "TikTok Video Script",
          description: "Short-form video scripts that go viral and build followings",
          role: "You are a TikTok content creator who understands viral trends and creates engaging short-form content."
        },
        podcast_outline: {
          name: "Podcast Episode Outline",
          description: "Structured podcast outlines that keep episodes focused and engaging",
          role: "You are a podcast producer who creates outlines that help hosts deliver valuable, engaging episodes."
        },
        video_ad_script: {
          name: "Video Advertisement Script",
          description: "Persuasive video ad scripts that drive conversions and sales",
          role: "You are an advertising specialist who creates video scripts that capture attention and drive measurable results."
        },
        tutorial_script: {
          name: "Tutorial Video Script",
          description: "Educational video scripts that teach complex topics clearly",
          role: "You are an educational content creator who breaks down complex topics into digestible, actionable lessons."
        },
        webinar_outline: {
          name: "Webinar Presentation Outline",
          description: "Structured webinar outlines that educate and convert attendees",
          role: "You are a webinar strategist who creates presentations that provide value while generating business results."
        }
      },
      social: {
        instagram_post: {
          name: "Instagram Post & Caption",
          description: "Engaging Instagram content that drives likes, comments, and meaningful engagement",
          role: "You are a social media expert who creates Instagram content that drives authentic engagement and builds community."
        },
        linkedin_post: {
          name: "LinkedIn Professional Post",
          description: "Professional LinkedIn content that builds authority and drives business connections",
          role: "You are a LinkedIn content strategist who helps professionals build their personal brand and generate business opportunities."
        },
        twitter_thread: {
          name: "Twitter Thread",
          description: "Engaging Twitter threads that educate and build following",
          role: "You are a Twitter content creator who understands how to use threads to share valuable information and grow your audience."
        },
        facebook_ad_copy: {
          name: "Facebook Ad Copy",
          description: "Compelling Facebook ad copy that drives clicks and conversions",
          role: "You are a Facebook advertising specialist who writes ad copy that captures attention and drives measurable results."
        },
        instagram_story: {
          name: "Instagram Story Series",
          description: "Engaging Instagram story content that drives interaction and builds connection",
          role: "You are an Instagram story strategist who creates content that keeps audiences engaged and coming back for more."
        },
        social_media_strategy: {
          name: "Social Media Strategy",
          description: "Comprehensive social media strategies that align with business goals",
          role: "You are a social media strategist who develops comprehensive plans that turn social presence into business results."
        }
      },
      career: {
        resume_summary: {
          name: "Resume Professional Summary",
          description: "Compelling resume summaries that capture recruiter attention and highlight key qualifications",
          role: "You are a career coach and resume expert who helps professionals create summaries that get interviews."
        },
        cover_letter: {
          name: "Cover Letter",
          description: "Personalized cover letters that connect your experience to specific job requirements",
          role: "You are a career strategist who writes cover letters that get candidates noticed and invited for interviews."
        },
        linkedin_headline: {
          name: "LinkedIn Headline Optimization",
          description: "Attention-grabbing LinkedIn headlines that improve profile visibility and attract opportunities",
          role: "You are a personal branding expert who optimizes LinkedIn profiles to attract opportunities and build professional networks."
        },
        interview_prep: {
          name: "Interview Question Responses",
          description: "Structured responses to common interview questions using proven frameworks",
          role: "You are an interview coach who helps candidates prepare compelling responses that demonstrate their qualifications and fit."
        },
        networking_message: {
          name: "Professional Networking Message",
          description: "Effective networking messages that build relationships and open doors",
          role: "You are a networking strategist who helps professionals build meaningful connections that advance their careers."
        },
        performance_review: {
          name: "Performance Review Self-Assessment",
          description: "Strategic self-assessments that highlight achievements and set up promotion discussions",
          role: "You are a career advancement coach who helps professionals position themselves for promotions and recognition."
        }
      },
      business: {
        business_plan: {
          name: "Business Plan Executive Summary",
          description: "Compelling executive summaries that capture investor attention and communicate business potential",
          role: "You are a business strategy consultant who helps entrepreneurs create business plans that secure funding and partnerships."
        },
        investor_pitch: {
          name: "Investor Pitch Deck Content",
          description: "Persuasive pitch deck content that secures funding and strategic partnerships",
          role: "You are a startup advisor who helps entrepreneurs create pitch decks that win over investors and secure funding."
        },
        market_analysis: {
          name: "Market Research Report",
          description: "Comprehensive market analysis that informs strategic business decisions",
          role: "You are a market research analyst who provides insights that help businesses make informed strategic decisions."
        },
        product_launch: {
          name: "Product Launch Strategy",
          description: "Comprehensive launch plans that maximize market impact and adoption",
          role: "You are a product marketing expert who develops launch strategies that drive awareness, adoption, and revenue."
        },
        competitive_analysis: {
          name: "Competitive Analysis Report",
          description: "Strategic competitive intelligence that identifies opportunities and threats",
          role: "You are a competitive intelligence analyst who helps businesses understand their competitive landscape and identify strategic opportunities."
        },
        sales_strategy: {
          name: "Sales Strategy Development",
          description: "Comprehensive sales strategies that drive revenue growth and market expansion",
          role: "You are a sales strategy expert who helps businesses develop systematic approaches to revenue generation and customer acquisition."
        }
      }
    };

    // ===== CATEGORY-SPECIFIC GUIDANCE =====
    const categoryGuidance = {
      email: {
        goal: "Define specific email outcome: open rate %, response rate, meeting bookings, or sales conversions",
        context: "Include sender relationship, recipient pain points, timing considerations, and competitive landscape",
        tone: "Match recipient expectations: cold prospects need trust-building, warm leads can be more direct",
        role: "Specify email expertise: cold outreach specialist, nurture sequence expert, or sales closer",
        constraints: "Set email-specific limits: word count (cold emails <150 words), personalization scale, compliance requirements",
        examples: "Show successful email templates: subject lines that work, opening hooks, clear CTAs"
      },
      creative: {
        goal: "Define creative impact: brand awareness, engagement metrics, content virality, or conversion goals",
        context: "Include brand voice, target audience psychographics, platform algorithms, current trends",
        tone: "Match platform and audience: TikTok casual vs LinkedIn professional vs Instagram authentic",
        role: "Specify creative expertise: content strategist, copywriter, brand storyteller, or viral content creator",
        constraints: "Set creative boundaries: platform requirements, brand guidelines, content pillars, posting frequency",
        examples: "Show high-performing content: viral post formats, engagement-driving headlines, proven content structures"
      },
      video: {
        goal: "Define video success: view duration %, subscriber growth, click-through rates, or watch time optimization",
        context: "Include platform algorithm preferences, audience retention patterns, competitive analysis, trending topics",
        tone: "Match platform energy: YouTube educational vs TikTok viral vs LinkedIn thought leadership",
        role: "Specify video expertise: YouTube strategist, short-form creator, educational content producer, or viral specialist",
        constraints: "Set video-specific limits: duration (TikTok 15-60s, YouTube 8-12 min), hook timing (first 3-15 seconds critical)",
        examples: "Show proven video structures: hook-promise-payoff format, pattern interrupts, strong CTAs that drive action"
      },
      social: {
        goal: "Define social metrics: engagement rate %, follower growth, share velocity, or community building outcomes",
        context: "Include platform nuances, audience demographics, peak posting times, hashtag strategy, community guidelines",
        tone: "Platform-optimized voice: Twitter witty, Instagram authentic, LinkedIn professional, TikTok entertaining",
        role: "Specify social expertise: community manager, influencer strategist, brand voice specialist, or viral content creator",
        constraints: "Platform-specific rules: character limits, hashtag limits (Instagram 30, Twitter 2-3), posting frequency guidelines",
        examples: "Show viral content patterns: trending formats, engagement hooks, community-building techniques, shareable moments"
      },
      career: {
        goal: "Define career advancement: interview invitations, salary negotiations, promotion discussions, or network expansion",
        context: "Include industry standards, career level, company culture, hiring manager priorities, market conditions",
        tone: "Professional confidence: humble expert vs assertive leader vs collaborative team player",
        role: "Specify career expertise: resume strategist, interview coach, LinkedIn optimizer, or salary negotiator",
        constraints: "Career-specific requirements: ATS compatibility, industry keywords, quantified achievements, professional standards",
        examples: "Show successful formats: STAR method responses, achievement statements with metrics, industry-specific language"
      },
      business: {
        goal: "Define business impact: revenue growth %, operational efficiency, stakeholder buy-in, or competitive advantage",
        context: "Include market conditions, stakeholder priorities, budget constraints, timeline pressures, regulatory environment",
        tone: "Executive-level communication: data-driven confidence, strategic thinking, risk-aware optimism",
        role: "Specify business expertise: strategy consultant, market analyst, executive advisor, or transformation specialist",
        constraints: "Business requirements: budget parameters, timeline constraints, compliance needs, stakeholder approval levels",
        examples: "Show winning formats: executive summaries, ROI projections, risk mitigation strategies, implementation roadmaps"
      },
      custom: {
        goal: "Be specific about your desired outcome and success criteria",
        context: "Provide background: audience, industry, constraints, current situation",
        tone: "Define voice and personality that matches your audience",
        role: "Define what type of expert the AI should be",
        constraints: "Set clear boundaries and requirements",
        examples: "Show 2-3 concrete examples of exactly what you want"
      }
    };

    function updateCategoryHints(category) {
      const guidance = categoryGuidance[category] || categoryGuidance.custom;
      
      const hintElements = {
        goalHint: guidance.goal,
        contextHint: guidance.context,
        toneHint: guidance.tone,
        roleHint: guidance.role,
        constraintsHint: guidance.constraints,
        examplesHint: guidance.examples
      };
      
      Object.keys(hintElements).forEach(hintId => {
        const element = document.getElementById(hintId);
        if (element) {
          element.textContent = hintElements[hintId];
        }
      });
    }

    // ===== UTILITY FUNCTIONS =====
    function showCopySuccess(message) {
      const successMessage = document.getElementById('copySuccess');
      successMessage.innerHTML = `
        <svg class="icon" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"></polyline></svg>
        ${message}
      `;
      successMessage.classList.add('show');
      setTimeout(() => {
        successMessage.classList.remove('show');
      }, 2000);
    }

    // ===== MAIN FUNCTIONS =====
    function switchCategory(category) {
      TemplatePersistence.save();
      
      StateManager.setCategory(category);
      StateManager.setTemplate(null);
      
      // ACCORDION BEHAVIOR: Hide output section when switching categories
      document.getElementById('outputSection').classList.remove('show');
      
      // SURGICAL FIX: Reset workbench when entering build mode
      WorkbenchManager.renderWelcomeState();
      
      // UPDATE CATEGORY-SPECIFIC HINTS
      updateCategoryHints(category);
      
      if (category === 'custom') {
        TemplateManager.showCustomMode();
        FieldManager.showAllFields();
        FormManager.show();
        
        setTimeout(() => {
          TemplatePersistence.load();
        }, 100);
      } else {
        TemplateManager.renderForCategory(category);
        FieldManager.hideAllFields();
        FormManager.hide();
      }
      
      document.getElementById('templatesSection').classList.add('show');
      QualityManager.updateDisplay();
      
      document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`[data-category="${category}"]`).classList.add('active');
    }

    function selectTemplate(templateKey) {
      TemplateManager.select(templateKey);
      FieldManager.showAllFields();
      FormManager.show();
      
      // ACCORDION BEHAVIOR: Hide templates section when selecting template
      document.getElementById('templatesSection').classList.remove('show');
      
      QualityManager.updateDisplay();
      
      setTimeout(() => {
        document.getElementById('formSection').scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }

    function generatePrompt() {
      // Show loading state immediately
      const generateBtn = document.querySelector('.btn-primary');
      const originalText = generateBtn.innerHTML;
      generateBtn.innerHTML = `
        <svg class="icon animate-spin" viewBox="0 0 24 24" width="16" height="16">
          <path d="M21,12a9,9 0 1,1-6.3-8.5"></path>
        </svg>
        Generating...
      `;
      generateBtn.disabled = true;
      generateBtn.style.opacity = '0.8';
      
      const formData = FormManager.getFormData();
      const template = TemplateManager.getTemplate();
      
      if (!FormManager.validateRequired()) {
        // Reset button on validation failure
        generateBtn.innerHTML = originalText;
        generateBtn.disabled = false;
        generateBtn.style.opacity = '1';
        alert('Please complete Goal, Context, and Tone fields to generate a quality prompt.');
        return;
      }
      
      TemplatePersistence.save();
      
      let prompt = '';
      
      const { currentCategory } = StateManager.getState();
      if (currentCategory === 'custom' && formData.role) {
        prompt += formData.role + '\n\n';
      } else if (template && template.role) {
        prompt += template.role + '\n\n';
      }
      
      prompt += `Your task: ${formData.goal}\n\n`;
      
      if (formData.context) {
        prompt += `Context: ${formData.context}\n\n`;
      }
      
      const formatToUse = formData.format || (template && template.format);
      if (formatToUse) {
        const formatMap = {
          'paragraph': 'Provide your response in well-structured paragraphs',
          'list': 'Format your response as a clear, numbered or bulleted list',
          'table': 'Present information in a structured table format',
          'code': 'Provide code examples with proper formatting and comments',
          'dialogue': 'Write in dialogue or conversation format',
          'step-by-step': 'Break down your response into clear, sequential steps'
        };
        
        if (formatMap[formatToUse]) {
          prompt += `Format: ${formatMap[formatToUse]}\n\n`;
        }
      }
      
      if (formData.tone) {
        prompt += `Tone and style: ${formData.tone}\n\n`;
      }
      
      const constraintsToUse = formData.constraints || (template && template.constraints);
      if (constraintsToUse) {
        prompt += `Important constraints: ${constraintsToUse}\n\n`;
      }
      
      const examplesToUse = formData.examples || (template && template.examples);
      if (examplesToUse) {
        prompt += `Examples of desired output:\n${examplesToUse}\n\n`;
      }
      
      prompt += "Please provide your response following all the above guidelines and requirements.";
      
      StateManager.setPrompt(prompt);
      document.getElementById('outputTextarea').value = prompt;
      
      // ACCORDION BEHAVIOR: Hide form section when generating prompt
      document.getElementById('formSection').classList.remove('show');
      document.getElementById('qualityPanel').style.display = 'none';
      document.getElementById('qualityPanelBottom').style.display = 'none';
      
      document.getElementById('outputSection').classList.add('show');
      
      // Reset button state
      generateBtn.innerHTML = originalText;
      generateBtn.disabled = false;
      generateBtn.style.opacity = '1';
      
      setTimeout(() => {
        document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }

    function clearForm() {
      TemplatePersistence.clear();
      
      StateManager.clearState();
      FormManager.clearAll();
      FieldManager.hideAllFields();
      
      document.querySelectorAll('.category-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      FormManager.hide();
      document.getElementById('templatesSection').classList.remove('show');
      document.getElementById('templatesSection').innerHTML = `
        <div class="templates-header">
          <h3 class="templates-title">SELECT A CATEGORY ABOVE</h3>
        </div>
        <div class="templates-content">
          <div class="welcome-state">
            <div class="welcome-icon">
              <svg viewBox="0 0 24 24" width="48" height="48" stroke="currentColor" fill="none" stroke-width="2"><line x1="12" x2="12" y1="19" y2="5"></line><polyline points="5,12 12,5 19,12"></polyline></svg>
            </div>
            <h3 class="welcome-title">Choose a Category to Begin</h3>
            <p class="welcome-text">Select from the categories above to view professional templates and get started with your prompt.</p>
          </div>
        </div>
      `;
      
      document.getElementById('outputSection').classList.remove('show');
      document.getElementById('outputTextarea').value = '';
      document.getElementById('qualityPanel').style.display = 'none';
      document.getElementById('qualityPanelBottom').style.display = 'none';
      
      QualityManager.updateDisplay();
    }

    function tryAnotherTemplate() {
      // ACCORDION BEHAVIOR: Show templates and hide output when trying another template
      document.getElementById('templatesSection').classList.add('show');
      document.getElementById('outputSection').classList.remove('show');
      
      setTimeout(() => {
        document.getElementById('templatesSection').scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }

    function copyPrompt() {
      const textarea = document.getElementById('outputTextarea');
      navigator.clipboard.writeText(textarea.value).then(() => {
        showCopySuccess('Copied to clipboard!');
      });
    }

    function savePrompt() {
      const prompt = document.getElementById('outputTextarea').value;
      if (!prompt.trim()) {
        alert('No prompt to save. Please generate a prompt first.');
        return;
      }
      
      SaveDialogManager.show(prompt);
    }

    function testQualitySystem() {
      console.log('🧪 Testing Completion Status System...');
      
      ['goal', 'context', 'tone', 'role', 'format', 'constraints', 'examples'].forEach(id => {
        const field = document.getElementById(id);
        if (field) field.value = '';
      });
      
      QualityManager.updateDisplay();
      
      setTimeout(() => {
        document.getElementById('goal').value = 'Write a blog post';
        console.log('TEST 1: Added goal (should be INCOMPLETE)');
        QualityManager.updateDisplay();
        
        setTimeout(() => {
          document.getElementById('context').value = 'For a tech startup audience';
          document.getElementById('tone').value = 'Professional but approachable';
          console.log('TEST 2: Added context and tone (should be MINIMUM COMPLETE)');
          QualityManager.updateDisplay();
          
          setTimeout(() => {
            document.getElementById('constraints').value = 'Keep under 1000 words, include actionable tips';
            console.log('TEST 3: Added constraints (should be ENHANCED PROMPT)');
            QualityManager.updateDisplay();
            
            alert('Completion status system test complete! Check the console for logs and watch the status display change.');
          }, 1000);
        }, 1000);
      }, 1000);
    }

    function exportCurrentPromptText() {
      const promptContent = document.getElementById('outputTextarea').value;
      
      if (!promptContent.trim()) {
        alert('No prompt to export. Please generate a prompt first.');
        return;
      }
      
      let textContent = 'ThinkPrompt - Generated Prompt\n';
      textContent += '==============================\n\n';
      textContent += promptContent;
      textContent += '\n\n';
      textContent += `Generated: ${new Date().toLocaleString()}\n`;
      
      const blob = new Blob([textContent], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `thinkprompt-prompt-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showCopySuccess('Prompt exported as text file!');
    }

    function exportCurrentPromptCSV() {
      const promptContent = document.getElementById('outputTextarea').value;
      
      if (!promptContent.trim()) {
        alert('No prompt to export. Please generate a prompt first.');
        return;
      }
      
      const date = new Date().toLocaleString();
      const content = `"${promptContent.replace(/"/g, '""')}"`;
      const dateCreated = `"${date}"`;
      
      let csvContent = 'Content,Date Generated\n';
      csvContent += `${content},${dateCreated}\n`;
      
      const blob = new Blob([csvContent], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `thinkprompt-prompt-${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showCopySuccess('Prompt exported as CSV file!');
    }

    function initializeFormListeners() {
      const fields = ['goal', 'context', 'tone', 'role', 'format', 'constraints', 'examples'];
      
      fields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
          field.addEventListener('input', () => {
            QualityManager.updateDisplay();
            TemplatePersistence.save();
          });
          field.addEventListener('change', () => {
            QualityManager.updateDisplay();
            TemplatePersistence.save();
          });
        }
      });
    }

    function initializeCategoryTabs() {
      document.querySelectorAll('.category-tab').forEach(tab => {
        tab.addEventListener('click', () => {
          const category = tab.dataset.category;
          switchCategory(category);
        });
      });
    }

    // ===== INITIALIZATION =====
    document.addEventListener('DOMContentLoaded', () => {
      console.log('🚀 ThinkPrompt initializing with HONEST COMPLETION SYSTEM...');
      console.log('🔧 Template data hotfixed from restored file');
      
      initializeCategoryTabs();
      initializeFormListeners();
      QualityManager.updateDisplay();
      WorkbenchManager.init();
      
      TemplatePersistence.cleanup();
      
      console.log('✅ ThinkPrompt honest completion system hotfix complete!');
    });
  </script>
</div>
</body>
</html>